(window.webpackJsonp=window.webpackJsonp||[]).push([[188],{533:function(a,s,t){"use strict";t.r(s);var n=t(4),e=Object(n.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("p",[a._v("学习不走弯路，"),s("a",{attrs:{href:"#%E5%85%AC%E4%BC%97%E5%8F%B7"}},[a._v("关注公众号")]),a._v(" 回复「学习路线」，获取mall项目专属学习路线！")]),a._v(" "),s("h1",{attrs:{id:"mysql如何实时同步数据到es-试试这款阿里开源的神器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mysql如何实时同步数据到es-试试这款阿里开源的神器"}},[a._v("#")]),a._v(" MySQL如何实时同步数据到ES？试试这款阿里开源的神器！")]),a._v(" "),s("blockquote",[s("p",[s("code",[a._v("mall")]),a._v("项目中的商品搜索功能，一直都没有做实时数据同步。最近发现阿里巴巴开源的"),s("code",[a._v("canal")]),a._v("可以把MySQL中的数据实时同步到Elasticsearch中，能很好地解决数据同步问题。今天我们来讲讲"),s("code",[a._v("canal")]),a._v("的使用，希望对大家有所帮助！")])]),a._v(" "),s("h2",{attrs:{id:"canal简介"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#canal简介"}},[a._v("#")]),a._v(" canal简介")]),a._v(" "),s("p",[a._v("canal主要用途是对MySQL数据库增量日志进行解析，提供增量数据的订阅和消费，简单说就是可以对MySQL的增量数据进行实时同步，支持同步到MySQL、Elasticsearch、HBase等数据存储中去。")]),a._v(" "),s("h2",{attrs:{id:"canal工作原理"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#canal工作原理"}},[a._v("#")]),a._v(" canal工作原理")]),a._v(" "),s("p",[a._v("canal会模拟MySQL主库和从库的交互协议，从而伪装成MySQL的从库，然后向MySQL主库发送dump协议，MySQL主库收到dump请求会向canal推送binlog，canal通过解析binlog将数据同步到其他存储中去。")]),a._v(" "),s("p",[s("img",{attrs:{src:"/img/mall/canal_start_01.png",alt:"canal工作原理图"}})]),a._v(" "),s("h2",{attrs:{id:"canal使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#canal使用"}},[a._v("#")]),a._v(" canal使用")]),a._v(" "),s("blockquote",[s("p",[a._v("接下来我们来学习下canal的使用，以MySQL实时同步数据到Elasticsearch为例。")])]),a._v(" "),s("h3",{attrs:{id:"组件下载"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#组件下载"}},[a._v("#")]),a._v(" 组件下载")]),a._v(" "),s("ul",[s("li",[a._v("首先我们需要下载canal的各个组件"),s("code",[a._v("canal-server")]),a._v("、"),s("code",[a._v("canal-adapter")]),a._v("、"),s("code",[a._v("canal-admin")]),a._v("，下载地址：https://github.com/alibaba/canal/releases")])]),a._v(" "),s("p",[s("img",{attrs:{src:"/img/mall/canal_start_02.png",alt:""}})]),a._v(" "),s("ul",[s("li",[s("p",[a._v("canal的各个组件的用途各不相同，下面分别介绍下：")]),a._v(" "),s("ul",[s("li",[a._v("canal-server（canal-deploy）：可以直接监听MySQL的binlog，把自己伪装成MySQL的从库，只负责接收数据，并不做处理。")]),a._v(" "),s("li",[a._v("canal-adapter：相当于canal的客户端，会从canal-server中获取数据，然后对数据进行同步，可以同步到MySQL、Elasticsearch和HBase等存储中去。")]),a._v(" "),s("li",[a._v("canal-admin：为canal提供整体配置管理、节点运维等面向运维的功能，提供相对友好的WebUI操作界面，方便更多用户快速和安全的操作。")])])]),a._v(" "),s("li",[s("p",[a._v("由于不同版本的MySQL、Elasticsearch和canal会有兼容性问题，所以我们先对其使用版本做个约定。")])])]),a._v(" "),s("table",[s("thead",[s("tr",[s("th",[a._v("应用")]),a._v(" "),s("th",[a._v("端口")]),a._v(" "),s("th",[a._v("版本")])])]),a._v(" "),s("tbody",[s("tr",[s("td",[a._v("MySQL")]),a._v(" "),s("td",[a._v("3306")]),a._v(" "),s("td",[a._v("5.7")])]),a._v(" "),s("tr",[s("td",[a._v("Elasticsearch")]),a._v(" "),s("td",[a._v("9200")]),a._v(" "),s("td",[a._v("7.6.2")])]),a._v(" "),s("tr",[s("td",[a._v("Kibanba")]),a._v(" "),s("td",[a._v("5601")]),a._v(" "),s("td",[a._v("7.6.2")])]),a._v(" "),s("tr",[s("td",[a._v("canal-server")]),a._v(" "),s("td",[a._v("11111")]),a._v(" "),s("td",[a._v("1.1.15")])]),a._v(" "),s("tr",[s("td",[a._v("canal-adapter")]),a._v(" "),s("td",[a._v("8081")]),a._v(" "),s("td",[a._v("1.1.15")])]),a._v(" "),s("tr",[s("td",[a._v("canal-admin")]),a._v(" "),s("td",[a._v("8089")]),a._v(" "),s("td",[a._v("1.1.15")])])])]),a._v(" "),s("h3",{attrs:{id:"mysql配置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#mysql配置"}},[a._v("#")]),a._v(" MySQL配置")]),a._v(" "),s("ul",[s("li",[a._v("由于canal是通过订阅MySQL的binlog来实现数据同步的，所以我们需要开启MySQL的binlog写入功能，并设置"),s("code",[a._v("binlog-format")]),a._v("为ROW模式，我的配置文件为"),s("code",[a._v("/mydata/mysql/conf/my.cnf")]),a._v("，改为如下内容即可；")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("mysqld"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## 设置server_id，同一局域网中需要唯一")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("server_id")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("101")]),a._v(" \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## 指定不需要同步的数据库名称")]),a._v("\nbinlog-ignore-db"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mysql  \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## 开启二进制日志功能")]),a._v("\nlog-bin"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mall-mysql-bin  \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## 设置二进制日志使用内存大小（事务）")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("binlog_cache_size")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("1M  \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## 设置使用的二进制日志格式（mixed,statement,row）")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("binlog_format")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("row  \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## 二进制日志过期清理时间。默认值为0，表示不自动清理。")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("expire_logs_days")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("7")]),a._v("  \n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## 跳过主从复制中遇到的所有错误或指定类型的错误，避免slave端复制中断。")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## 如：1062错误是指一些主键重复，1032错误是因为主从数据库数据不一致")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("slave_skip_errors")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1062")]),a._v("  \n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br")])]),s("ul",[s("li",[a._v("配置完成后需要重新启动MySQL，重启成功后通过如下命令查看binlog是否启用；")])]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" variables "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("like")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'%log_bin%'")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("+---------------------------------+-------------------------------------+\n| Variable_name                   | Value                               |\n+---------------------------------+-------------------------------------+\n| log_bin                         | ON                                  |\n| log_bin_basename                | /var/lib/mysql/mall-mysql-bin       |\n| log_bin_index                   | /var/lib/mysql/mall-mysql-bin.index |\n| log_bin_trust_function_creators | OFF                                 |\n| log_bin_use_v1_row_events       | OFF                                 |\n| sql_log_bin                     | ON                                  |\n+---------------------------------+-------------------------------------+\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br")])]),s("ul",[s("li",[a._v("再查看下MySQL的binlog模式；")])]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("show")]),a._v(" variables "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("like")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'binlog_format%'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("  \n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("+---------------+-------+\n| Variable_name | Value |\n+---------------+-------+\n| binlog_format | ROW   |\n+---------------+-------+\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("ul",[s("li",[a._v("接下来需要创建一个拥有从库权限的账号，用于订阅binlog，这里创建的账号为"),s("code",[a._v("canal:canal")]),a._v("；")])]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("USER")]),a._v(" canal IDENTIFIED "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BY")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'canal'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("  \n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("GRANT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SELECT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REPLICATION")]),a._v(" SLAVE"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("REPLICATION")]),a._v(" CLIENT "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ON")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TO")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'canal'")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@'%'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\nFLUSH "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("PRIVILEGES")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br")])]),s("ul",[s("li",[a._v("创建好测试用的数据库"),s("code",[a._v("canal-test")]),a._v("，之后创建一张商品表"),s("code",[a._v("product")]),a._v("，建表语句如下。")])]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CREATE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("TABLE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("`")]),a._v("product"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("`")])]),a._v("  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("`")]),a._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("`")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("bigint")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("20")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("NOT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("NULL")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("AUTO_INCREMENT")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("`")]),a._v("title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("`")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("255")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CHARACTER")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" utf8 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("COLLATE")]),a._v(" utf8_general_ci "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("NULL")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DEFAULT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("NULL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("`")]),a._v("sub_title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("`")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("255")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CHARACTER")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" utf8 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("COLLATE")]),a._v(" utf8_general_ci "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("NULL")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DEFAULT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("NULL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("`")]),a._v("price"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("`")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("decimal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("10")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("NULL")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DEFAULT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("NULL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("`")]),a._v("pic"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("`")])]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("varchar")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("255")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CHARACTER")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" utf8 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("COLLATE")]),a._v(" utf8_general_ci "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("NULL")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DEFAULT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("NULL")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("PRIMARY")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("KEY")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),s("span",{pre:!0,attrs:{class:"token identifier"}},[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("`")]),a._v("id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("`")])]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("USING")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("BTREE")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("ENGINE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("InnoDB")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("AUTO_INCREMENT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("CHARACTER")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" utf8 "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("COLLATE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" utf8_general_ci ROW_FORMAT "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" Dynamic"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br")])]),s("h3",{attrs:{id:"canal-server使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#canal-server使用"}},[a._v("#")]),a._v(" canal-server使用")]),a._v(" "),s("ul",[s("li",[a._v("将我们下载好的压缩包"),s("code",[a._v("canal.deployer-1.1.5-SNAPSHOT.tar.gz")]),a._v("上传到Linux服务器，然后解压到指定目录"),s("code",[a._v("/mydata/canal-server")]),a._v("，可使用如下命令解压；")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tar")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-zxvf")]),a._v(" canal.deployer-1.1.5-SNAPSHOT.tar.gz\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("解压完成后目录结构如下；")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("├── bin\n│   ├── restart.sh\n│   ├── startup.bat\n│   ├── startup.sh\n│   └── stop.sh\n├── conf\n│   ├── canal_local.properties\n│   ├── canal.properties\n│   └── example\n│       └── instance.properties\n├── lib\n├── logs\n│   ├── canal\n│   │   └── canal.log\n│   └── example\n│       ├── example.log\n│       └── example.log\n└── plugin\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br")])]),s("ul",[s("li",[a._v("修改配置文件"),s("code",[a._v("conf/example/instance.properties")]),a._v("，按如下配置即可，主要是修改数据库相关配置；")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("# 需要同步数据的MySQL地址\ncanal.instance.master.address=127.0.0.1:3306\ncanal.instance.master.journal.name=\ncanal.instance.master.position=\ncanal.instance.master.timestamp=\ncanal.instance.master.gtid=\n# 用于同步数据的数据库账号\ncanal.instance.dbUsername=canal\n# 用于同步数据的数据库密码\ncanal.instance.dbPassword=canal\n# 数据库连接编码\ncanal.instance.connectionCharset = UTF-8\n# 需要订阅binlog的表过滤正则表达式\ncanal.instance.filter.regex=.*\\\\..*\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br")])]),s("ul",[s("li",[a._v("使用"),s("code",[a._v("startup.sh")]),a._v("脚本启动"),s("code",[a._v("canal-server")]),a._v("服务；")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" bin/startup.sh\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("启动成功后可使用如下命令查看服务日志信息；")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tail")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" logs/canal/canal.log\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2020")]),a._v("-10-26 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(":18:13.354 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" INFO  com.alibaba.otter.canal.deployer.CanalController - "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## start the canal server[172.17.0.1(172.17.0.1):11111]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2020")]),a._v("-10-26 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(":18:19.978 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" INFO  com.alibaba.otter.canal.deployer.CanalStarter - "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("## the canal server is running now ......")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("ul",[s("li",[a._v("启动成功后可使用如下命令查看instance日志信息；")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tail")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" logs/example/example.log \n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2020")]),a._v("-10-26 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(":18:16.056 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" from class path resource "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("canal.properties"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2020")]),a._v("-10-26 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(":18:16.061 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" INFO  c.a.o.c.i.spring.support.PropertyPlaceholderConfigurer - Loading properties "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("file")]),a._v(" from class path resource "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("example/instance.properties"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2020")]),a._v("-10-26 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(":18:18.259 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" INFO  c.a.otter.canal.instance.spring.CanalInstanceWithSpring - start CannalInstance "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("-example \n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2020")]),a._v("-10-26 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(":18:18.282 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" WARN  c.a.o.canal.parse.inbound.mysql.dbsync.LogEventConvert - --"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" init table filter "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" ^.*"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("*$\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2020")]),a._v("-10-26 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(":18:18.282 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" WARN  c.a.o.canal.parse.inbound.mysql.dbsync.LogEventConvert - --"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" init table black filter "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" ^mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v(".slave_.*$\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2020")]),a._v("-10-26 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(":18:19.543 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("destination "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" example , address "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" /127.0.0.1:3306 , EventParser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" begin to "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("find")]),a._v(" start position, it will be long "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("time")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" reset or first position\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2020")]),a._v("-10-26 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(":18:19.578 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("main"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" INFO  c.a.otter.canal.instance.core.AbstractCanalInstance - start successful"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("..")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2020")]),a._v("-10-26 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(":18:19.912 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("destination "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" example , address "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" /127.0.0.1:3306 , EventParser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - prepare to "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("find")]),a._v(" start position just last position\n "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"identity"')]),a._v(":"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"slaveId"')]),a._v(":-1,"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"sourceAddress"')]),a._v(":"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"address"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"localhost"')]),a._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"port"')]),a._v(":3306"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"postion"')]),a._v(":"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"gtid"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('""')]),a._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"included"')]),a._v(":false,"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"journalName"')]),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"mall-mysql-bin.000006"')]),a._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"position"')]),a._v(":2271,"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"serverId"')]),a._v(":101,"),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"timestamp"')]),a._v(":1603682664000"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2020")]),a._v("-10-26 "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("16")]),a._v(":18:22.435 "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("destination "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" example , address "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(" /127.0.0.1:3306 , EventParser"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" WARN  c.a.o.c.p.inbound.mysql.rds.RdsBinlogEventParserProxy - ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("find")]),a._v(" start position successfully, EntryPosition"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("included"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("false,journalName"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("mall-mysql-bin.000006,position"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2271")]),a._v(",serverId"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("101")]),a._v(",gtid"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v(",timestamp"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1603682664000")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" cost "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" 2768ms , the next step is binlog dump\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br")])]),s("ul",[s("li",[a._v("如果想要停止"),s("code",[a._v("canal-server")]),a._v("服务可以使用如下命令。")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" bin/stop.sh\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"canal-adapter使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#canal-adapter使用"}},[a._v("#")]),a._v(" canal-adapter使用")]),a._v(" "),s("ul",[s("li",[a._v("将我们下载好的压缩包"),s("code",[a._v("canal.adapter-1.1.5-SNAPSHOT.tar.gz")]),a._v("上传到Linux服务器，然后解压到指定目录"),s("code",[a._v("/mydata/canal-adpter")]),a._v("，解压完成后目录结构如下；")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("├── bin\n│   ├── adapter.pid\n│   ├── restart.sh\n│   ├── startup.bat\n│   ├── startup.sh\n│   └── stop.sh\n├── conf\n│   ├── application.yml\n│   ├── es6\n│   ├── es7\n│   │   ├── biz_order.yml\n│   │   ├── customer.yml\n│   │   └── product.yml\n│   ├── hbase\n│   ├── kudu\n│   ├── logback.xml\n│   ├── META-INF\n│   │   └── spring.factories\n│   └── rdb\n├── lib\n├── logs\n│   └── adapter\n│       └── adapter.log\n└── plugin\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br")])]),s("ul",[s("li",[a._v("修改配置文件"),s("code",[a._v("conf/application.yml")]),a._v("，按如下配置即可，主要是修改canal-server配置、数据源配置和客户端适配器配置；")])]),a._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("canal.conf")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("mode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" tcp "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 客户端的模式，可选tcp kafka rocketMQ")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("flatMessage")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean important"}},[a._v("true")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 扁平message开关, 是否以json字符串形式投递数据, 仅在kafka/rocketMQ模式下有效")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("zookeeperHosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 对应集群模式下的zk地址")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("syncBatchSize")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1000")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 每次同步的批数量")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("retries")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("0")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 重试次数, -1为无限重试")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("timeout")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 同步超时时间, 单位毫秒")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("accessKey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("secretKey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("consumerProperties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# canal tcp consumer")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("canal.tcp.server.host")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 127.0.0.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("11111")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#设置canal-server的地址")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("canal.tcp.zookeeper.hosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("canal.tcp.batch.size")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("500")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("canal.tcp.username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("canal.tcp.password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("srcDataSources")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 源数据库配置")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("defaultDS")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" jdbc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("//127.0.0.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("3306/canal_test"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("?")]),a._v("useUnicode=true\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" canal\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" canal\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("canalAdapters")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 适配器列表")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("instance")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" example "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# canal实例名或者MQ topic名")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("groups")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 分组列表")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" g1 "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 分组id, 如果是MQ模式将用到该值")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("outerAdapters")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" logger "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 日志打印适配器")]),a._v("\n      "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" es7 "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ES同步适配器")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("hosts")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 127.0.0.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("9200")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ES连接地址")]),a._v("\n        "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("properties")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("mode")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" rest "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 模式可选transport(9300) 或者 rest(9200)")]),a._v("\n          "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# security.auth: test:123456 #  only used for rest mode")]),a._v("\n          "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("cluster.name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" elasticsearch "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# ES集群名称")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br"),s("span",{staticClass:"line-number"},[a._v("22")]),s("br"),s("span",{staticClass:"line-number"},[a._v("23")]),s("br"),s("span",{staticClass:"line-number"},[a._v("24")]),s("br"),s("span",{staticClass:"line-number"},[a._v("25")]),s("br"),s("span",{staticClass:"line-number"},[a._v("26")]),s("br"),s("span",{staticClass:"line-number"},[a._v("27")]),s("br"),s("span",{staticClass:"line-number"},[a._v("28")]),s("br"),s("span",{staticClass:"line-number"},[a._v("29")]),s("br"),s("span",{staticClass:"line-number"},[a._v("30")]),s("br"),s("span",{staticClass:"line-number"},[a._v("31")]),s("br"),s("span",{staticClass:"line-number"},[a._v("32")]),s("br"),s("span",{staticClass:"line-number"},[a._v("33")]),s("br"),s("span",{staticClass:"line-number"},[a._v("34")]),s("br")])]),s("ul",[s("li",[a._v("添加配置文件"),s("code",[a._v("canal-adapter/conf/es7/product.yml")]),a._v("，用于配置MySQL中的表与Elasticsearch中索引的映射关系；")])]),a._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("dataSourceKey")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" defaultDS "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 源数据源的key, 对应上面配置的srcDataSources中的值")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("destination")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" example  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# canal的instance或者MQ的topic")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("groupId")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" g1 "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 对应MQ模式下的groupId, 只会同步对应groupId的数据")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("esMapping")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("_index")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" canal_product "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# es 的索引名称")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("_id")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" _id  "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# es 的_id, 如果不配置该项必须配置下面的pk项_id则会由es自动分配")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("sql")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(' "SELECT\n        \tp.id AS _id'),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n        \tp.title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n        \tp.sub_title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v("\n        \tp.price"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v('\n        \tp.pic\n        FROM\n        \tproduct p"        '),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# sql映射")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("etlCondition")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"where a.c_time>={}"')]),a._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("#etl的条件参数")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("commitBatch")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3000")]),a._v("   "),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 提交批大小")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br")])]),s("ul",[s("li",[a._v("使用"),s("code",[a._v("startup.sh")]),a._v("脚本启动"),s("code",[a._v("canal-adapter")]),a._v("服务；")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" bin/startup.sh\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("启动成功后可使用如下命令查看服务日志信息；")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tail")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" logs/adapter/adapter.log\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("20-10-26 16:52:55.148 [main] INFO  c.a.o.canal.adapter.launcher.loader.CanalAdapterLoader - Load canal adapter: logger succeed\n2020-10-26 16:52:57.005 [main] INFO  c.a.o.c.client.adapter.es.core.config.ESSyncConfigLoader - ## Start loading es mapping config ... \n2020-10-26 16:52:57.376 [main] INFO  c.a.o.c.client.adapter.es.core.config.ESSyncConfigLoader - ## ES mapping config loaded\n2020-10-26 16:52:58.615 [main] INFO  c.a.o.canal.adapter.launcher.loader.CanalAdapterLoader - Load canal adapter: es7 succeed\n2020-10-26 16:52:58.651 [main] INFO  c.alibaba.otter.canal.connector.core.spi.ExtensionLoader - extension classpath dir: /mydata/canal-adapter/plugin\n2020-10-26 16:52:59.043 [main] INFO  c.a.o.canal.adapter.launcher.loader.CanalAdapterLoader - Start adapter for canal-client mq topic: example-g1 succeed\n2020-10-26 16:52:59.044 [main] INFO  c.a.o.canal.adapter.launcher.loader.CanalAdapterService - ## the canal client adapters are running now ......\n2020-10-26 16:52:59.057 [Thread-4] INFO  c.a.otter.canal.adapter.launcher.loader.AdapterProcessor - =============> Start to connect destination: example <=============\n2020-10-26 16:52:59.100 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler [\"http-nio-8081\"]\n2020-10-26 16:52:59.153 [main] INFO  org.apache.tomcat.util.net.NioSelectorPool - Using a shared selector for servlet write/read\n2020-10-26 16:52:59.590 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8081 (http) with context path ''\n2020-10-26 16:52:59.626 [main] INFO  c.a.otter.canal.adapter.launcher.CanalAdapterApplication - Started CanalAdapterApplication in 31.278 seconds (JVM running for 33.99)\n2020-10-26 16:52:59.930 [Thread-4] INFO  c.a.otter.canal.adapter.launcher.loader.AdapterProcessor - =============> Subscribe destination: example succeed <=============\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br")])]),s("ul",[s("li",[a._v("如果需要停止"),s("code",[a._v("canal-adapter")]),a._v("服务可以使用如下命令。")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" bin/stop.sh\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"数据同步演示"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#数据同步演示"}},[a._v("#")]),a._v(" 数据同步演示")]),a._v(" "),s("blockquote",[s("p",[a._v("经过上面的一系列步骤，canal的数据同步功能已经基本可以使用了，下面我们来演示下数据同步功能。")])]),a._v(" "),s("ul",[s("li",[a._v("首先我们需要在Elasticsearch中创建索引，和MySQL中的product表相对应，直接在Kibana的"),s("code",[a._v("Dev Tools")]),a._v("中使用如下命令创建即可；")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('PUT canal_product\n{\n  "mappings": {\n    "properties": {\n      "title": {\n        "type": "text"\n      },\n      "sub_title": {\n        "type": "text"\n      },\n      "pic": {\n        "type": "text"\n      },\n      "price": {\n        "type": "double"\n      }\n    }\n  }\n}\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br")])]),s("p",[s("img",{attrs:{src:"/img/mall/canal_start_03.png",alt:""}})]),a._v(" "),s("ul",[s("li",[a._v("创建完成后可以查看下索引的结构；")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("GET canal_product/_mapping\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/img/mall/canal_start_04.png",alt:""}})]),a._v(" "),s("ul",[s("li",[a._v("之后使用如下SQL语句在数据库中创建一条记录；")])]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INSERT")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("INTO")]),a._v(" product "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v(" id"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" sub_title"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" price"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" pic "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("VALUES")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'小米8'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("' 全面屏游戏智能手机 6GB+64GB'")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1999.00")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(",")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token boolean"}},[a._v("NULL")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("创建成功后，在Elasticsearch中搜索下，发现数据已经同步了；")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("GET canal_product/_search\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[s("img",{attrs:{src:"/img/mall/canal_start_05.png",alt:""}})]),a._v(" "),s("ul",[s("li",[a._v("再使用如下SQL对数据进行修改；")])]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("UPDATE")]),a._v(" product "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("SET")]),a._v(" title"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'小米10'")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WHERE")]),a._v(" id"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("修改成功后，在Elasticsearch中搜索下，发现数据已经修改了；")])]),a._v(" "),s("p",[s("img",{attrs:{src:"/img/mall/canal_start_06.png",alt:""}})]),a._v(" "),s("ul",[s("li",[a._v("再使用如下SQL对数据进行删除操作；")])]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("DELETE")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("FROM")]),a._v(" product "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("WHERE")]),a._v(" id"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("删除成功后，在Elasticsearch中搜索下，发现数据已经删除了，至此MySQL同步到Elasticsearch的功能完成了！")])]),a._v(" "),s("p",[s("img",{attrs:{src:"/img/mall/canal_start_07.png",alt:""}})]),a._v(" "),s("h3",{attrs:{id:"canal-admin使用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#canal-admin使用"}},[a._v("#")]),a._v(" canal-admin使用")]),a._v(" "),s("ul",[s("li",[a._v("将我们下载好的压缩包"),s("code",[a._v("canal.admin-1.1.5-SNAPSHOT.tar.gz")]),a._v("上传到Linux服务器，然后解压到指定目录"),s("code",[a._v("/mydata/canal-admin")]),a._v("，解压完成后目录结构如下；")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("├── bin\n│   ├── restart.sh\n│   ├── startup.bat\n│   ├── startup.sh\n│   └── stop.sh\n├── conf\n│   ├── application.yml\n│   ├── canal_manager.sql\n│   ├── canal-template.properties\n│   ├── instance-template.properties\n│   ├── logback.xml\n│   └── public\n│       ├── avatar.gif\n│       ├── index.html\n│       ├── logo.png\n│       └── static\n├── lib\n└── logs\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br")])]),s("ul",[s("li",[a._v("创建canal-admin需要使用的数据库"),s("code",[a._v("canal_manager")]),a._v("，创建SQL脚本为"),s("code",[a._v("/mydata/canal-admin/conf/canal_manager.sql")]),a._v("，会创建如下表；")])]),a._v(" "),s("p",[s("img",{attrs:{src:"/img/mall/canal_start_08.png",alt:""}})]),a._v(" "),s("ul",[s("li",[a._v("修改配置文件"),s("code",[a._v("conf/application.yml")]),a._v("，按如下配置即可，主要是修改数据源配置和"),s("code",[a._v("canal-admin")]),a._v("的管理账号配置，注意需要用一个有读写权限的数据库账号，比如管理账号"),s("code",[a._v("root:root")]),a._v("；")])]),a._v(" "),s("div",{staticClass:"language-yaml line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-yaml"}},[s("code",[s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("server")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("port")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8089")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("jackson")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("date-format")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" yyyy"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("MM"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("-")]),a._v("dd HH"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("mm"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("ss\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("time-zone")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" GMT+8\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("spring.datasource")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("address")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" 127.0.0.1"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("database")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" canal_manager\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("username")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" root\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("password")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" root\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("driver-class-name")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" com.mysql.jdbc.Driver\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("url")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" jdbc"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("mysql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("//$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("spring.datasource.address"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),a._v("/$"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("{")]),a._v("spring.datasource.database"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("}")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("?")]),a._v("useUnicode=true"),s("span",{pre:!0,attrs:{class:"token important"}},[a._v("&characterEncoding=UTF-8&useSSL=false")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("hikari")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("maximum-pool-size")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("30")]),a._v("\n    "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("minimum-idle")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("\n\n"),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("canal")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v("\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("adminUser")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" admin\n  "),s("span",{pre:!0,attrs:{class:"token key atrule"}},[a._v("adminPasswd")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(":")]),a._v(" admin\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br"),s("span",{staticClass:"line-number"},[a._v("20")]),s("br"),s("span",{staticClass:"line-number"},[a._v("21")]),s("br")])]),s("ul",[s("li",[a._v("接下来对之前搭建的"),s("code",[a._v("canal-server")]),a._v("的"),s("code",[a._v("conf/canal_local.properties")]),a._v("文件进行配置，主要是修改"),s("code",[a._v("canal-admin")]),a._v("的配置，修改完成后使用"),s("code",[a._v("sh bin/startup.sh local")]),a._v("重启"),s("code",[a._v("canal-server")]),a._v("：")])]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("# register ip\ncanal.register.ip =\n\n# canal admin config\ncanal.admin.manager = 127.0.0.1:8089\ncanal.admin.port = 11110\ncanal.admin.user = admin\ncanal.admin.passwd = 4ACFE3202A5FF5CF467898FC58AAB1D615029441\n# admin auto register\ncanal.admin.register.auto = true\ncanal.admin.register.cluster = \n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br")])]),s("ul",[s("li",[a._v("使用"),s("code",[a._v("startup.sh")]),a._v("脚本启动"),s("code",[a._v("canal-admin")]),a._v("服务；")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("sh")]),a._v(" bin/startup.sh\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("ul",[s("li",[a._v("启动成功后可使用如下命令查看服务日志信息；")])]),a._v(" "),s("div",{staticClass:"language-bash line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-bash"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("tail")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-f")]),a._v(" logs/admin.log\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("020-10-27 10:15:04.210 [main] INFO  org.apache.coyote.http11.Http11NioProtocol - Starting ProtocolHandler [\"http-nio-8089\"]\n2020-10-27 10:15:04.308 [main] INFO  org.apache.tomcat.util.net.NioSelectorPool - Using a shared selector for servlet write/read\n2020-10-27 10:15:04.534 [main] INFO  o.s.boot.web.embedded.tomcat.TomcatWebServer - Tomcat started on port(s): 8089 (http) with context path ''\n2020-10-27 10:15:04.573 [main] INFO  com.alibaba.otter.canal.admin.CanalAdminApplication - Started CanalAdminApplication in 31.203 seconds (JVM running for 34.865)\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br")])]),s("ul",[s("li",[a._v("访问canal-admin的Web界面，输入账号密码"),s("code",[a._v("admin:123456")]),a._v("即可登录，访问地址：http://192.168.3.101:8089")])]),a._v(" "),s("p",[s("img",{attrs:{src:"/img/mall/canal_start_09.png",alt:""}})]),a._v(" "),s("ul",[s("li",[a._v("登录成功后即可使用Web界面操作canal-server。")])]),a._v(" "),s("p",[s("img",{attrs:{src:"/img/mall/canal_start_10.png",alt:""}})]),a._v(" "),s("h2",{attrs:{id:"参考资料"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#参考资料"}},[a._v("#")]),a._v(" 参考资料")]),a._v(" "),s("p",[a._v("canal官方文档：https://github.com/alibaba/canal/wiki")]),a._v(" "),s("h2",{attrs:{id:"配置文件地址"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#配置文件地址"}},[a._v("#")]),a._v(" 配置文件地址")]),a._v(" "),s("p",[a._v("https://github.com/macrozheng/mall-learning/tree/master/document/canal-config")]),a._v(" "),s("h2",{attrs:{id:"公众号"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#公众号"}},[a._v("#")]),a._v(" 公众号")]),a._v(" "),s("p",[s("img",{attrs:{src:"http://macro-oss.oss-cn-shenzhen.aliyuncs.com/mall/banner/qrcode_for_macrozheng_258.jpg",alt:"公众号图片"}})])])}),[],!1,null,null,null);s.default=e.exports}}]);
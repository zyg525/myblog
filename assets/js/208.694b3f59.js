(window.webpackJsonp=window.webpackJsonp||[]).push([[208],{550:function(s,a,t){"use strict";t.r(a);var n=t(4),e=Object(n.a)({},(function(){var s=this,a=s._self._c;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("p",[s._v("学习不走弯路，"),a("a",{attrs:{href:"#%E5%85%AC%E4%BC%97%E5%8F%B7"}},[s._v("关注公众号")]),s._v(" 回复「学习路线」，获取mall项目专属学习路线！")]),s._v(" "),a("h1",{attrs:{id:"使用jenkins一键打包部署前端应用-就是这么6"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#使用jenkins一键打包部署前端应用-就是这么6"}},[s._v("#")]),s._v(" 使用Jenkins一键打包部署前端应用，就是这么6！")]),s._v(" "),a("blockquote",[a("p",[s._v("上一次我们讲到了使用Jenkins一键打包部署SpringBoot应用，这一次我们来讲下如何一键打包部署前端应用，以Vue前端应用为例，这里我们使用"),a("code",[s._v("mall-admin-web")]),s._v("中的代码来进行演示。")])]),s._v(" "),a("h2",{attrs:{id:"学前准备"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#学前准备"}},[s._v("#")]),s._v(" 学前准备")]),s._v(" "),a("blockquote",[a("p",[s._v("学习本文需要一些Jenkins和Nginx的知识，对这些不熟悉的小伙伴可以参考以下文章。")])]),s._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/tQqvgSc9cHBtnqRQSbI4aw",target:"_blank",rel:"noopener noreferrer"}},[s._v("使用Jenkins一键打包部署SpringBoot应用，就是这么6！"),a("OutboundLink")],1)]),s._v(" "),a("li",[a("a",{attrs:{href:"https://mp.weixin.qq.com/s/9VZi2suAlomu1IRGy-qdCA",target:"_blank",rel:"noopener noreferrer"}},[s._v("Nginx的这些妙用，你肯定有不知道的！"),a("OutboundLink")],1)])]),s._v(" "),a("h2",{attrs:{id:"jenkins中的自动化部署"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#jenkins中的自动化部署"}},[s._v("#")]),s._v(" Jenkins中的自动化部署")]),s._v(" "),a("blockquote",[a("p",[s._v("Vue前端应用的打包需要依赖NodeJS插件，所以我们先安装并配置该插件，然后创建任务来打包部署。")])]),s._v(" "),a("h3",{attrs:{id:"安装nodejs插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#安装nodejs插件"}},[s._v("#")]),s._v(" 安装NodeJS插件")]),s._v(" "),a("ul",[a("li",[s._v("在系统设置->插件管理中选择安装插件；")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/mall/jenkins_vue_01.png",alt:""}})]),s._v(" "),a("ul",[a("li",[s._v("搜索"),a("code",[s._v("NodeJS")]),s._v("插件并进行安装；")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/mall/jenkins_vue_02.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"配置nodejs插件"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#配置nodejs插件"}},[s._v("#")]),s._v(" 配置NodeJS插件")]),s._v(" "),a("ul",[a("li",[s._v("在系统设置->全局工具配置中进行插件配置；")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/mall/jenkins_vue_03.png",alt:""}})]),s._v(" "),a("ul",[a("li",[s._v("选择"),a("code",[s._v("新增NodeJS")]),s._v("，配置好版本号以后，点击保存即可完成设置；")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/mall/jenkins_vue_04.png",alt:""}})]),s._v(" "),a("h3",{attrs:{id:"创建任务"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#创建任务"}},[s._v("#")]),s._v(" 创建任务")]),s._v(" "),a("blockquote",[a("p",[s._v("我们需要创建一个任务来打包部署我们的前端应用，这里以我的"),a("code",[s._v("mall-admin-web")]),s._v("项目为例。")])]),s._v(" "),a("ul",[a("li",[s._v("任务执行流程如下：")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/mall/jenkins_vue_11.png",alt:""}})]),s._v(" "),a("ul",[a("li",[s._v("构建一个自由风格的软件项目：")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/mall/jenkins_vue_05.png",alt:""}})]),s._v(" "),a("ul",[a("li",[s._v("在源码管理中添加Git代码仓库相关配置，这里我使用的Gitee上面的代码，地址为：https://gitee.com/macrozheng/mall-admin-web")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/mall/jenkins_vue_06.png",alt:""}})]),s._v(" "),a("ul",[a("li",[s._v("在构建环境中把我们的"),a("code",[s._v("node")]),s._v("环境添加进去：")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/mall/jenkins_vue_07.png",alt:""}})]),s._v(" "),a("ul",[a("li",[s._v("添加一个"),a("code",[s._v("执行shell")]),s._v("的构建，用于将我们的前端代码进行编译打包：")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/mall/jenkins_vue_08.png",alt:""}})]),s._v(" "),a("ul",[a("li",[s._v("构建脚本如下：")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看版本信息")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-v")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 解决存放在Github上的sass无法下载的问题")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SASS_BINARY_SITE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://npm.taobao.org/mirrors/node-sass/ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" node-sass\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 将镜像源替换为淘宝的加速访问")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" config "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" registry https://registry.npm.taobao.org\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 安装项目依赖")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 项目打包")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" run build\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br")])]),a("ul",[a("li",[s._v("添加一个"),a("code",[s._v("使用ssh执行远程脚本")]),s._v("的构建，用于将我们打包后的代码发布到Nginx中去：")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/mall/jenkins_vue_09.png",alt:""}})]),s._v(" "),a("ul",[a("li",[s._v("远程执行脚本如下：")])]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" stop nginx\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'----stop nginx----'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("rm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-rf")]),s._v(" /mydata/nginx/html\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'----rm html dir----'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("cp")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token parameter variable"}},[s._v("-r")]),s._v(" /mydata/jenkins_home/workspace/mall-admin-web/dist /mydata/nginx/html\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'----cp dist dir to html dir----'")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("docker")]),s._v(" start nginx\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("echo")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'----start nginx----'")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br")])]),a("ul",[a("li",[s._v("点击保存后，直接在任务列表中点击运行即可完成自动化部署：")])]),s._v(" "),a("p",[a("img",{attrs:{src:"/img/mall/jenkins_vue_10.png",alt:""}})]),s._v(" "),a("h2",{attrs:{id:"遇到的坑"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#遇到的坑"}},[s._v("#")]),s._v(" 遇到的坑")]),s._v(" "),a("h3",{attrs:{id:"node-sass无法下载导致构建失败"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#node-sass无法下载导致构建失败"}},[s._v("#")]),s._v(" node-sass无法下载导致构建失败")]),s._v(" "),a("p",[s._v("由于node-sass的源使用的是Github上面的，经常无法访问，我们构建的时候需要单独设置node-sass的下载地址。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# linux")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SASS_BINARY_SITE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://npm.taobao.org/mirrors/node-sass/ "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" node-sass\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# window")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token assign-left variable"}},[s._v("SASS_BINARY_SITE")]),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("=")]),s._v("https://npm.taobao.org/mirrors/node-sass"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("&&")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("install")]),s._v(" node-sass\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h3",{attrs:{id:"有些依赖无法下载导致构建失败"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#有些依赖无法下载导致构建失败"}},[s._v("#")]),s._v(" 有些依赖无法下载导致构建失败")]),s._v(" "),a("p",[s._v("由于npm源访问慢的问题，有些源可能会无法下载，改用淘宝的npm源即可解决。")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置为淘宝的镜像源")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" config "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" registry https://registry.npm.taobao.org\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置为官方镜像源")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token function"}},[s._v("npm")]),s._v(" config "),a("span",{pre:!0,attrs:{class:"token builtin class-name"}},[s._v("set")]),s._v(" registry https://registry.npmjs.org\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br")])]),a("h2",{attrs:{id:"项目地址"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#项目地址"}},[s._v("#")]),s._v(" 项目地址")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://github.com/macrozheng/mall-admin-web",target:"_blank",rel:"noopener noreferrer"}},[s._v("https://github.com/macrozheng/mall-admin-web"),a("OutboundLink")],1)]),s._v(" "),a("h2",{attrs:{id:"公众号"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#公众号"}},[s._v("#")]),s._v(" 公众号")]),s._v(" "),a("p",[a("img",{attrs:{src:"http://macro-oss.oss-cn-shenzhen.aliyuncs.com/mall/banner/qrcode_for_macrozheng_258.jpg",alt:"公众号图片"}})])])}),[],!1,null,null,null);a.default=e.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[103],{444:function(s,t,e){"use strict";e.r(t);var a=e(4),r=Object(a.a)({},(function(){var s=this,t=s._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[t("h2",{attrs:{id:"一、简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#一、简介"}},[s._v("#")]),s._v(" 一、简介")]),s._v(" "),t("h3",{attrs:{id:"spring-security简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#spring-security简介"}},[s._v("#")]),s._v(" Spring Security简介")]),s._v(" "),t("p",[s._v("Spring Security是一个功能强大且高度可定制的身份验证和访问控制框架。提供了完善的"),t("strong",[s._v("认证机制")]),s._v("和方法级的"),t("strong",[s._v("授权功能")]),s._v("。是一款非常优秀的权限管理框架。它的核心是一组过滤器链，不同的功能经由不同的过滤器。")]),s._v(" "),t("h3",{attrs:{id:"jwt简介"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#jwt简介"}},[s._v("#")]),s._v(" JWT简介")]),s._v(" "),t("p",[t("strong",[s._v("JWT(JSON Web Token)")]),s._v("，是一种用于通信双方之间传递安全信息的简洁的、URL安全的表述性声明规范。一个JWT实际上就是一个字符串，它由三部分组成，头部、载荷与签名，用"),t("code",[s._v(".")]),s._v("分隔：")]),s._v(" "),t("div",{staticClass:"language- line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-text"}},[t("code",[s._v("eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Inp5ZyJ9.8TYNlySs_KOU-vC0R4ajL08c5TthGQa3CVakeyKA6ug\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br")])]),t("p",[s._v("在https://jwt.io/可以解析出它的内容：")]),s._v(" "),t("div",{staticClass:"language-json line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-json"}},[t("code",[s._v("HEADER"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("ALGORITHM & TOKEN TYPE\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"typ"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"JWT"')]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"alg"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"HS256"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nPAYLOAD"),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v("DATA\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),t("span",{pre:!0,attrs:{class:"token property"}},[s._v('"username"')]),t("span",{pre:!0,attrs:{class:"token operator"}},[s._v(":")]),s._v(" "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"zyg"')]),s._v("\n"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\nVERIFY SIGNATURE\nHMACSHA256(\n  base64UrlEncode(header) + "),t("span",{pre:!0,attrs:{class:"token string"}},[s._v('"."')]),s._v(" +\n  base64UrlEncode(payload)"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(",")]),s._v("\n  your"),t("span",{pre:!0,attrs:{class:"token number"}},[s._v("-256")]),s._v("-bit-secret\n) secret base64 encoded\n")])]),s._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[s._v("1")]),t("br"),t("span",{staticClass:"line-number"},[s._v("2")]),t("br"),t("span",{staticClass:"line-number"},[s._v("3")]),t("br"),t("span",{staticClass:"line-number"},[s._v("4")]),t("br"),t("span",{staticClass:"line-number"},[s._v("5")]),t("br"),t("span",{staticClass:"line-number"},[s._v("6")]),t("br"),t("span",{staticClass:"line-number"},[s._v("7")]),t("br"),t("span",{staticClass:"line-number"},[s._v("8")]),t("br"),t("span",{staticClass:"line-number"},[s._v("9")]),t("br"),t("span",{staticClass:"line-number"},[s._v("10")]),t("br"),t("span",{staticClass:"line-number"},[s._v("11")]),t("br"),t("span",{staticClass:"line-number"},[s._v("12")]),t("br"),t("span",{staticClass:"line-number"},[s._v("13")]),t("br"),t("span",{staticClass:"line-number"},[s._v("14")]),t("br"),t("span",{staticClass:"line-number"},[s._v("15")]),t("br"),t("span",{staticClass:"line-number"},[s._v("16")]),t("br"),t("span",{staticClass:"line-number"},[s._v("17")]),t("br")])]),t("h3",{attrs:{id:"基本原理"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#基本原理"}},[s._v("#")]),s._v(" 基本原理")]),s._v(" "),t("p",[s._v("权限管理分为两部分，一是认证，解决你是谁的问题，具体表现为注册和登录，二是授权，解决你能干什么的问题，具体表现为你登录后有哪些权限。")]),s._v(" "),t("p",[s._v("对于注册，基本思路是先使用不可逆加密算法对用户密码进行加密，并存放在数据库中，如果想提高安全性，可以给每个密码加上随机生成的salt值，并将salt值一并存放到数据库中。")]),s._v(" "),t("p",[s._v("对于登录，基本思路是先从数据库中查询用户名，如果用户名存在，再使用同样的算法对登录密码进行加密，如果两个密码相同，则登录成功，同时根据用户名生成一个token，返回给客户端。")]),s._v(" "),t("p",[s._v("对于授权，基本思路是用户请求中携带着上一次登录时返回的token，服务器对token进行解析，确认是本人访问，再从数据库中查询出该用户拥有的角色，这样用户就可以访问该角色有权访问的路径了。")]),s._v(" "),t("h2",{attrs:{id:"二、实战"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#二、实战"}},[s._v("#")]),s._v(" 二、实战")]),s._v(" "),t("p",[s._v("项目的结构如下图所示：")]),s._v(" "),t("p",[t("img",{attrs:{src:"/myblog/img/java/learnJWT%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84.png",alt:"learnJWT项目结构"}})]),s._v(" "),t("p",[t("strong",[s._v("使用密码登录的过程")]),s._v("："),t("code",[s._v("LoginController")]),s._v("(接收请求) -> "),t("code",[s._v("AuthenticationManager")]),s._v("(调用MyJwtProvider) -> "),t("code",[s._v("MyJwtProvider")]),s._v("(调用UserDetailsService) -> "),t("code",[s._v("UserDetailsService")]),s._v("(调用MyUserServiceImpl) -> "),t("code",[s._v("MyUserServiceImpl")]),s._v("(查询数据库)。")]),s._v(" "),t("p",[t("strong",[s._v("使用token免密访问并管理权限的过程")]),s._v("："),t("code",[s._v("MyJwtFilter")]),s._v("(接收请求、解析校验token、调用UserDetailsService) -> "),t("code",[s._v("UserDetailsService")]),s._v(" -> "),t("code",[s._v("UserDetailsService")]),s._v("(调用MyUserServiceImpl) -> "),t("code",[s._v("MyUserServiceImpl")]),s._v("(查询数据库) -> "),t("code",[s._v("LoginController")]),s._v("(根据查询到的角色信息校验权限)。")]),s._v(" "),t("p"),s._v(" "),t("p",[s._v("源码地址：https://github.com/zyg525/learnJWT")]),s._v(" "),t("p"),s._v(" "),t("p",[s._v("参考资料：")]),s._v(" "),t("p",[s._v("1、https://shusheng007.top/2023/02/15/springsecurity/")]),s._v(" "),t("p",[s._v("2、https://www.cnblogs.com/little-monster-lhq/p/17250186.html")])])}),[],!1,null,null,null);t.default=r.exports}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([[192],{536:function(a,s,e){"use strict";e.r(s);var t=e(4),r=Object(t.a)({},(function(){var a=this,s=a._self._c;return s("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[s("p",[a._v("学习不走弯路，"),s("a",{attrs:{href:"#%E5%85%AC%E4%BC%97%E5%8F%B7"}},[a._v("关注公众号")]),a._v(" 回复「学习路线」，获取mall项目专属学习路线！")]),a._v(" "),s("h1",{attrs:{id:"使用dockerfile为springboot应用构建docker镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用dockerfile为springboot应用构建docker镜像"}},[a._v("#")]),a._v(" 使用Dockerfile为SpringBoot应用构建Docker镜像")]),a._v(" "),s("blockquote",[s("p",[a._v("上次写过一篇"),s("a",{attrs:{href:"https://mp.weixin.qq.com/s/q2KDzHbPkf3Q0EY8qYjYgw",target:"_blank",rel:"noopener noreferrer"}},[a._v("使用Maven插件构建Docker镜像"),s("OutboundLink")],1),a._v(" ，讲述了通过docker-maven-plugin来构建docker镜像的方式，此种方式需要依赖自建的Registry镜像仓库。本文将讲述另一种方式，使用Dockerfile来构建docker镜像，此种方式不需要依赖自建的镜像仓库，只需要应用的jar包和一个Dockerfile文件即可。")])]),a._v(" "),s("h2",{attrs:{id:"dockerfile常用指令"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#dockerfile常用指令"}},[a._v("#")]),a._v(" Dockerfile常用指令")]),a._v(" "),s("h3",{attrs:{id:"add"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#add"}},[a._v("#")]),a._v(" ADD")]),a._v(" "),s("p",[a._v("用于复制文件，格式：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("ADD <src> <dest>\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("示例：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 将当前目录下的mall-tiny-docker-file.jar包复制到docker容器的/目录下")]),a._v("\nADD mall-tiny-docker-file.jar /mall-tiny-docker-file.jar\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h3",{attrs:{id:"entrypoint"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#entrypoint"}},[a._v("#")]),a._v(" ENTRYPOINT")]),a._v(" "),s("p",[a._v("指定docker容器启动时执行的命令，格式：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('ENTRYPOINT ["executable", "param1","param2"...]\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("示例：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 指定docker容器启动时运行jar包")]),a._v("\nENTRYPOINT "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"java"')]),a._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"-jar"')]),a._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/mall-tiny-docker-file.jar"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h3",{attrs:{id:"env"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#env"}},[a._v("#")]),a._v(" ENV")]),a._v(" "),s("p",[a._v("用于设置环境变量，格式：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("ENV <key> <value>\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("示例：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# mysql运行时设置root密码")]),a._v("\nENV MYSQL_ROOT_PASSWORD root\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h3",{attrs:{id:"expose"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#expose"}},[a._v("#")]),a._v(" EXPOSE")]),a._v(" "),s("p",[a._v("声明需要暴露的端口(只声明不会打开端口)，格式：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("EXPOSE <port1> <port2> ...\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("示例：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 声明服务运行在8080端口")]),a._v("\nEXPOSE "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8080")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h3",{attrs:{id:"from"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#from"}},[a._v("#")]),a._v(" FROM")]),a._v(" "),s("p",[a._v("指定所需依赖的基础镜像，格式：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("FROM <image>:<tag>\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("示例：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 该镜像需要依赖的java8的镜像")]),a._v("\nFROM java:8\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h3",{attrs:{id:"maintainer"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#maintainer"}},[a._v("#")]),a._v(" MAINTAINER")]),a._v(" "),s("p",[a._v("指定维护者的名字，格式：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v("MAINTAINER <name>\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("p",[a._v("示例：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("MAINTAINER macrozheng\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h3",{attrs:{id:"run"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#run"}},[a._v("#")]),a._v(" RUN")]),a._v(" "),s("p",[a._v("在容器构建过程中执行的命令，我们可以用该命令自定义容器的行为，比如安装一些软件，创建一些文件等，格式：")]),a._v(" "),s("div",{staticClass:"language- line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-text"}},[s("code",[a._v('RUN <command>\nRUN ["executable", "param1","param2"...]\n')])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("示例：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 在容器构建过程中需要在/目录下创建一个mall-tiny-docker-file.jar文件")]),a._v("\nRUN "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("bash")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'touch /mall-tiny-docker-file.jar'")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h2",{attrs:{id:"使用dockerfile构建springboot应用镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用dockerfile构建springboot应用镜像"}},[a._v("#")]),a._v(" 使用Dockerfile构建SpringBoot应用镜像")]),a._v(" "),s("h3",{attrs:{id:"编写dockerfile文件"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#编写dockerfile文件"}},[a._v("#")]),a._v(" 编写Dockerfile文件")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 该镜像需要依赖的基础镜像")]),a._v("\nFROM java:8\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 将当前目录下的jar包复制到docker容器的/目录下")]),a._v("\nADD mall-tiny-docker-file-0.0.1-SNAPSHOT.jar /mall-tiny-docker-file.jar\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 运行过程中创建一个mall-tiny-docker-file.jar文件")]),a._v("\nRUN "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("bash")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'touch /mall-tiny-docker-file.jar'")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 声明服务运行在8080端口")]),a._v("\nEXPOSE "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8080")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 指定docker容器启动时运行jar包")]),a._v("\nENTRYPOINT "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"java"')]),a._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"-jar"')]),a._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/mall-tiny-docker-file.jar"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# 指定维护者的名字")]),a._v("\nMAINTAINER macrozheng\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br")])]),s("h3",{attrs:{id:"使用maven打包应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#使用maven打包应用"}},[a._v("#")]),a._v(" 使用maven打包应用")]),a._v(" "),s("p",[a._v("在IDEA中双击package命令进行打包:"),s("br"),a._v(" "),s("img",{attrs:{src:"/img/mall/refer_screen_91.png",alt:""}}),s("br"),a._v("\n打包成功后展示：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" --- spring-boot-maven-plugin:2.1.3.RELEASE:repackage "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("(")]),a._v("repackage"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(")")]),a._v(" @ mall-tiny-docker-file ---\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" Replacing main artifact with repackaged archive\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" ------------------------------------------------------------------------\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" BUILD SUCCESS\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" ------------------------------------------------------------------------\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" Total time: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("30.749")]),a._v(" s\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" Finished at: "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2019")]),a._v("-06-16T14:11:07+08:00\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" Final Memory: 43M/306M\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),a._v("INFO"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v(" ------------------------------------------------------------------------\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br")])]),s("p",[a._v("将应用jar包及Dockerfile文件上传到linux服务器：\n"),s("img",{attrs:{src:"/img/mall/refer_screen_92.png",alt:""}}),a._v(" "),s("img",{attrs:{src:"/img/mall/refer_screen_95.png",alt:""}})]),a._v(" "),s("h3",{attrs:{id:"在linux上构建docker镜像"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#在linux上构建docker镜像"}},[a._v("#")]),a._v(" 在Linux上构建docker镜像")]),a._v(" "),s("p",[a._v("在Dockerfile所在目录执行以下命令：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token comment"}},[a._v("# -t 表示指定镜像仓库名称/镜像名称:镜像标签 .表示使用当前目录下的Dockerfile")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" build "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-t")]),a._v(" mall-tiny/mall-tiny-docker-file:0.0.1-SNAPSHOT "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(".")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("p",[a._v("输出如下信息：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("Sending build context to Docker daemon  "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("36")]),a._v(".37MB\nStep "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("1")]),a._v("/5 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" FROM java:8\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" d23bdf5b1b1b\nStep "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("2")]),a._v("/5 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" ADD mall-tiny-docker-file-0.0.1-SNAPSHOT.jar /mall-tiny-docker-file.jar\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" c920c9e9d045\nStep "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3")]),a._v("/5 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" RUN "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("bash")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-c")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'touch /mall-tiny-docker-file.jar'")]),a._v("\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" Running "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" 55506f517f19\nRemoving intermediate container 55506f517f19\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" 0727eded66dc\nStep "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("4")]),a._v("/5 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" EXPOSE "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8080")]),a._v("\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" Running "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" d67a5f50aa7d\nRemoving intermediate container d67a5f50aa7d\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" 1b8b4506eb2d\nStep "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("5")]),a._v("/5 "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v(":")]),a._v(" ENTRYPOINT "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"java"')]),a._v(", "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"-jar"')]),a._v(","),s("span",{pre:!0,attrs:{class:"token string"}},[a._v('"/mall-tiny-docker-file.jar"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" Running "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("in")]),a._v(" 0c5bf61a0032\nRemoving intermediate container 0c5bf61a0032\n ---"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v(">")]),a._v(" c3614dad21b7\nSuccessfully built c3614dad21b7\nSuccessfully tagged mall-tiny/mall-tiny-docker-file:0.0.1-SNAPSHOT\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br"),s("span",{staticClass:"line-number"},[a._v("7")]),s("br"),s("span",{staticClass:"line-number"},[a._v("8")]),s("br"),s("span",{staticClass:"line-number"},[a._v("9")]),s("br"),s("span",{staticClass:"line-number"},[a._v("10")]),s("br"),s("span",{staticClass:"line-number"},[a._v("11")]),s("br"),s("span",{staticClass:"line-number"},[a._v("12")]),s("br"),s("span",{staticClass:"line-number"},[a._v("13")]),s("br"),s("span",{staticClass:"line-number"},[a._v("14")]),s("br"),s("span",{staticClass:"line-number"},[a._v("15")]),s("br"),s("span",{staticClass:"line-number"},[a._v("16")]),s("br"),s("span",{staticClass:"line-number"},[a._v("17")]),s("br"),s("span",{staticClass:"line-number"},[a._v("18")]),s("br"),s("span",{staticClass:"line-number"},[a._v("19")]),s("br")])]),s("p",[a._v("查看docker镜像：\n"),s("img",{attrs:{src:"/img/mall/refer_screen_93.png",alt:""}})]),a._v(" "),s("h3",{attrs:{id:"运行mysql服务并设置"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#运行mysql服务并设置"}},[a._v("#")]),a._v(" 运行mysql服务并设置")]),a._v(" "),s("h4",{attrs:{id:"_1-使用docker命令启动"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-使用docker命令启动"}},[a._v("#")]),a._v(" 1.使用docker命令启动：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("3306")]),a._v(":3306 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" mysql "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /mydata/mysql/log:/var/log/mysql "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /mydata/mysql/data:/var/lib/mysql "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /mydata/mysql/conf:/etc/mysql "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-e")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token assign-left variable"}},[a._v("MYSQL_ROOT_PASSWORD")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("root  "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" mysql:5.7\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br"),s("span",{staticClass:"line-number"},[a._v("6")]),s("br")])]),s("h4",{attrs:{id:"_2-进入运行mysql的docker容器"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_2-进入运行mysql的docker容器"}},[a._v("#")]),a._v(" 2.进入运行mysql的docker容器：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("exec")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-it")]),a._v(" mysql /bin/bash\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h4",{attrs:{id:"_3-使用mysql命令打开客户端"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_3-使用mysql命令打开客户端"}},[a._v("#")]),a._v(" 3.使用mysql命令打开客户端：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("mysql "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-uroot")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-proot")]),a._v(" --default-character-set"),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("=")]),a._v("utf8\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h4",{attrs:{id:"_4-修改root帐号的权限-使得任何ip都能访问"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_4-修改root帐号的权限-使得任何ip都能访问"}},[a._v("#")]),a._v(" 4.修改root帐号的权限，使得任何ip都能访问：")]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("grant")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("all")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("privileges")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("on")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),s("span",{pre:!0,attrs:{class:"token operator"}},[a._v("*")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("to")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[a._v("'root'")]),s("span",{pre:!0,attrs:{class:"token variable"}},[a._v("@'%'")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h4",{attrs:{id:"_5-创建mall数据库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_5-创建mall数据库"}},[a._v("#")]),a._v(" 5.创建mall数据库：")]),a._v(" "),s("div",{staticClass:"language-sql line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-sql"}},[s("code",[s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("create")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("database")]),a._v(" mall "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("character")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("set")]),a._v(" utf8\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h4",{attrs:{id:"_6-将mall-sql文件拷贝到mysql容器的-目录下"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_6-将mall-sql文件拷贝到mysql容器的-目录下"}},[a._v("#")]),a._v(" 6.将mall.sql文件拷贝到mysql容器的/目录下：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token function"}},[a._v("cp")]),a._v(" /mydata/mall.sql mysql:/\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br")])]),s("h4",{attrs:{id:"_7-将sql文件导入到数据库"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_7-将sql文件导入到数据库"}},[a._v("#")]),a._v(" 7.将sql文件导入到数据库：")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[a._v("use mall"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token builtin class-name"}},[a._v("source")]),a._v(" /mall.sql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(";")]),a._v("\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br")])]),s("h3",{attrs:{id:"运行mall-tiny-docker-file应用"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#运行mall-tiny-docker-file应用"}},[a._v("#")]),a._v(" 运行mall-tiny-docker-file应用")]),a._v(" "),s("div",{staticClass:"language-shell line-numbers-mode"},[s("pre",{pre:!0,attrs:{class:"language-shell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[a._v("docker")]),a._v(" run "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-p")]),a._v(" "),s("span",{pre:!0,attrs:{class:"token number"}},[a._v("8080")]),a._v(":8080 "),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--name")]),a._v(" mall-tiny-docker-file "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("--link")]),a._v(" mysql:db "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /etc/localtime:/etc/localtime "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-v")]),a._v(" /mydata/app/mall-tiny-docker-file/logs:/var/logs "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("\\")]),a._v("\n"),s("span",{pre:!0,attrs:{class:"token parameter variable"}},[a._v("-d")]),a._v(" mall-tiny/mall-tiny-docker-file:0.0.1-SNAPSHOT\n")])]),a._v(" "),s("div",{staticClass:"line-numbers-wrapper"},[s("span",{staticClass:"line-number"},[a._v("1")]),s("br"),s("span",{staticClass:"line-number"},[a._v("2")]),s("br"),s("span",{staticClass:"line-number"},[a._v("3")]),s("br"),s("span",{staticClass:"line-number"},[a._v("4")]),s("br"),s("span",{staticClass:"line-number"},[a._v("5")]),s("br")])]),s("p",[a._v("访问接口文档地址http://192.168.3.101:8080/swagger-ui.html：\n"),s("img",{attrs:{src:"/img/mall/refer_screen_94.png",alt:""}})]),a._v(" "),s("h2",{attrs:{id:"项目源码地址"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#项目源码地址"}},[a._v("#")]),a._v(" 项目源码地址")]),a._v(" "),s("p",[s("a",{attrs:{href:"https://github.com/macrozheng/mall-learning/tree/master/mall-tiny-docker-file",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/macrozheng/mall-learning/tree/master/mall-tiny-docker-file"),s("OutboundLink")],1)]),a._v(" "),s("h2",{attrs:{id:"公众号"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#公众号"}},[a._v("#")]),a._v(" 公众号")]),a._v(" "),s("p",[s("img",{attrs:{src:"http://macro-oss.oss-cn-shenzhen.aliyuncs.com/mall/banner/qrcode_for_macrozheng_258.jpg",alt:"公众号图片"}})])])}),[],!1,null,null,null);s.default=r.exports}}]);
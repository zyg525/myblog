(window.webpackJsonp=window.webpackJsonp||[]).push([[139],{482:function(a,t,s){"use strict";s.r(t);var n=s(4),e=Object(n.a)({},(function(){var a=this,t=a._self._c;return t("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[t("p",[a._v("学习不走弯路，"),t("a",{attrs:{href:"#%E5%85%AC%E4%BC%97%E5%8F%B7"}},[a._v("关注公众号")]),a._v(" 回复「学习路线」，获取mall项目专属学习路线！")]),a._v(" "),t("h1",{attrs:{id:"mybatis-generator使用过程中踩过的一个坑"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#mybatis-generator使用过程中踩过的一个坑"}},[a._v("#")]),a._v(" MyBatis Generator使用过程中踩过的一个坑")]),a._v(" "),t("blockquote",[t("p",[a._v("在使用MyBatis Generator生成代码的过程中，曾经遇到一个坑，每次生成mapper.xml的时候并不是直接覆盖原文件，而是在原文件中追加了新的内容，导致运行项目出错，本文主要讲解如何解决这个问题。")])]),a._v(" "),t("h2",{attrs:{id:"问题重现"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问题重现"}},[a._v("#")]),a._v(" 问题重现")]),a._v(" "),t("h3",{attrs:{id:"示例代码"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#示例代码"}},[a._v("#")]),a._v(" 示例代码")]),a._v(" "),t("p",[a._v("使用的是mall-tiny-02的代码，代码地址："),t("a",{attrs:{href:"https://github.com/macrozheng/mall-learning/tree/master/mall-tiny-02",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/macrozheng/mall-learning/tree/master/mall-tiny-02"),t("OutboundLink")],1)]),a._v(" "),t("h3",{attrs:{id:"直接运行malltinyapplication的main函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#直接运行malltinyapplication的main函数"}},[a._v("#")]),a._v(" 直接运行MallTinyApplication的main函数")]),a._v(" "),t("p",[a._v("发现正常运行，启动成功！\n"),t("img",{attrs:{src:"/img/mall/refer_screen_99.png",alt:""}})]),a._v(" "),t("h3",{attrs:{id:"运行代码生成器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#运行代码生成器"}},[a._v("#")]),a._v(" 运行代码生成器")]),a._v(" "),t("p",[a._v("运行com.macro.mall.tiny.mbg.Generator的main方法")]),a._v(" "),t("h3",{attrs:{id:"重新启动malltinyapplication的main函数"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重新启动malltinyapplication的main函数"}},[a._v("#")]),a._v(" 重新启动MallTinyApplication的main函数")]),a._v(" "),t("p",[a._v("发现已经无法正常运行，其中有这么一行关键性的错误：")]),a._v(" "),t("div",{staticClass:"language-java line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-java"}},[t("code",[a._v("nested exception is "),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[a._v("org"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("apache"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("ibatis"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("builder"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")])]),a._v("BuilderException")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Error")]),a._v(" parsing "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Mapper")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("XML"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("\nThe")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token constant"}},[a._v("XML")]),a._v(" location is 'file "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("[")]),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("D")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v("\\developer\\github\\mall"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("learning\\mall"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),a._v("tiny"),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v("-")]),t("span",{pre:!0,attrs:{class:"token number"}},[a._v("02")]),a._v("\\target\\classes\\com\\macro\\mall\\tiny\\mbg\\mapper\\"),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("PmsBrandMapper")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("xml"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("]")]),a._v("'"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Cause")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[a._v("java"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("lang"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")])]),a._v("IllegalArgumentException")]),t("span",{pre:!0,attrs:{class:"token operator"}},[a._v(":")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Result")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[a._v("Maps")]),a._v(" collection already contains value "),t("span",{pre:!0,attrs:{class:"token keyword"}},[a._v("for")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token class-name"}},[t("span",{pre:!0,attrs:{class:"token namespace"}},[a._v("com"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("macro"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("mall"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("tiny"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("mbg"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("mapper"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")])]),a._v("PmsBrandMapper"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(".")]),a._v("BaseResultMap")]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br")])]),t("p",[t("strong",[a._v("表明了PmsBrandMapper.xml文件解析错误，BaseResultMap重复定义。")])]),a._v(" "),t("h3",{attrs:{id:"查看pmsbrandmapper-xml文件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#查看pmsbrandmapper-xml文件"}},[a._v("#")]),a._v(" 查看PmsBrandMapper.xml文件")]),a._v(" "),t("p",[a._v("从中可以发现MyBatis Generator生成的mapper.xml文件信息是直接追加在原来的文件上的，并不是直接覆盖，导致了这个错误。\n"),t("img",{attrs:{src:"/img/mall/refer_screen_100.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"问题解决"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#问题解决"}},[a._v("#")]),a._v(" 问题解决")]),a._v(" "),t("blockquote",[t("p",[a._v("以前一直以为是MyBatis Generator生成的问题，直接删除mapper.xml所在文件夹，重新生成就好了,现在提供一种MyBatis Generator官方提供的解决方法。")])]),a._v(" "),t("h3",{attrs:{id:"升级mybatis-generator的版本"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#升级mybatis-generator的版本"}},[a._v("#")]),a._v(" 升级MyBatis Generator的版本")]),a._v(" "),t("p",[a._v("MyBatis Generator 在1.3.7版本提供了解决方案，我们目前使用的版本为1.3.3。")]),a._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("\x3c!-- MyBatis 生成器 --\x3e")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("org.mybatis.generator"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("groupId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("mybatis-generator-core"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("artifactId")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n    "),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("1.3.7"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("version")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("</")]),a._v("dependency")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v(">")])]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br"),t("span",{staticClass:"line-number"},[a._v("3")]),t("br"),t("span",{staticClass:"line-number"},[a._v("4")]),t("br"),t("span",{staticClass:"line-number"},[a._v("5")]),t("br"),t("span",{staticClass:"line-number"},[a._v("6")]),t("br")])]),t("h3",{attrs:{id:"在generatorconfig-xml文件中添加覆盖mapper-xml的插件"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#在generatorconfig-xml文件中添加覆盖mapper-xml的插件"}},[a._v("#")]),a._v(" 在generatorConfig.xml文件中添加覆盖mapper.xml的插件")]),a._v(" "),t("div",{staticClass:"language-xml line-numbers-mode"},[t("pre",{pre:!0,attrs:{class:"language-xml"}},[t("code",[t("span",{pre:!0,attrs:{class:"token comment"}},[a._v("\x3c!--生成mapper.xml时覆盖原文件--\x3e")]),a._v("\n"),t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token tag"}},[t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("<")]),a._v("plugin")]),a._v(" "),t("span",{pre:!0,attrs:{class:"token attr-name"}},[a._v("type")]),t("span",{pre:!0,attrs:{class:"token attr-value"}},[t("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[a._v("=")]),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')]),a._v("org.mybatis.generator.plugins.UnmergeableXmlMappersPlugin"),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v('"')])]),a._v(" "),t("span",{pre:!0,attrs:{class:"token punctuation"}},[a._v("/>")])]),a._v("\n")])]),a._v(" "),t("div",{staticClass:"line-numbers-wrapper"},[t("span",{staticClass:"line-number"},[a._v("1")]),t("br"),t("span",{staticClass:"line-number"},[a._v("2")]),t("br")])]),t("h3",{attrs:{id:"重新运行代码生成器"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#重新运行代码生成器"}},[a._v("#")]),a._v(" 重新运行代码生成器")]),a._v(" "),t("p",[a._v("发现PmsBrandMapper.xml生成已经正常，应用也可以正常运行了。\n"),t("img",{attrs:{src:"/img/mall/refer_screen_101.png",alt:""}})]),a._v(" "),t("p",[t("img",{attrs:{src:"/img/mall/refer_screen_102.png",alt:""}})]),a._v(" "),t("h2",{attrs:{id:"项目源码地址"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#项目源码地址"}},[a._v("#")]),a._v(" 项目源码地址")]),a._v(" "),t("p",[t("a",{attrs:{href:"https://github.com/macrozheng/mall-learning/tree/master/mall-tiny-02",target:"_blank",rel:"noopener noreferrer"}},[a._v("https://github.com/macrozheng/mall-learning/tree/master/mall-tiny-02"),t("OutboundLink")],1)]),a._v(" "),t("h2",{attrs:{id:"公众号"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#公众号"}},[a._v("#")]),a._v(" 公众号")]),a._v(" "),t("p",[t("img",{attrs:{src:"http://macro-oss.oss-cn-shenzhen.aliyuncs.com/mall/banner/qrcode_for_macrozheng_258.jpg",alt:"公众号图片"}})])])}),[],!1,null,null,null);t.default=e.exports}}]);
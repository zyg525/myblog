<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis缓存问题 | ZYG&#39;s blog</title>
    <meta name="generator" content="VuePress 1.9.10">
    <link rel="icon" href="/myblog/img/favicon.ico">
    <meta name="description" content="温故而知新">
    <meta name="keywords" content="Java、数据库、Linux、计算机基础">
    <meta name="baidu-site-verification" content="7F55weZDDc">
    <meta name="theme-color" content="#11a8cd">
    
    <link rel="preload" href="/myblog/assets/css/0.styles.c5ea190f.css" as="style"><link rel="preload" href="/myblog/assets/js/app.5079fcf9.js" as="script"><link rel="preload" href="/myblog/assets/js/3.96770396.js" as="script"><link rel="preload" href="/myblog/assets/js/2.5abed595.js" as="script"><link rel="preload" href="/myblog/assets/js/94.c00f81a6.js" as="script"><link rel="prefetch" href="/myblog/assets/js/1.96ab2c6f.js"><link rel="prefetch" href="/myblog/assets/js/10.a98e674a.js"><link rel="prefetch" href="/myblog/assets/js/100.08e347b9.js"><link rel="prefetch" href="/myblog/assets/js/101.9556ad17.js"><link rel="prefetch" href="/myblog/assets/js/102.673c78bf.js"><link rel="prefetch" href="/myblog/assets/js/103.348c9950.js"><link rel="prefetch" href="/myblog/assets/js/104.2ab661fb.js"><link rel="prefetch" href="/myblog/assets/js/105.0b2b41a2.js"><link rel="prefetch" href="/myblog/assets/js/106.269593e7.js"><link rel="prefetch" href="/myblog/assets/js/107.28a975f4.js"><link rel="prefetch" href="/myblog/assets/js/108.63ad6a55.js"><link rel="prefetch" href="/myblog/assets/js/109.0585e5b8.js"><link rel="prefetch" href="/myblog/assets/js/11.53145bf6.js"><link rel="prefetch" href="/myblog/assets/js/110.4ae81527.js"><link rel="prefetch" href="/myblog/assets/js/111.5ffce402.js"><link rel="prefetch" href="/myblog/assets/js/112.15ff260a.js"><link rel="prefetch" href="/myblog/assets/js/113.815f1dae.js"><link rel="prefetch" href="/myblog/assets/js/114.cfc9ad81.js"><link rel="prefetch" href="/myblog/assets/js/115.07143e84.js"><link rel="prefetch" href="/myblog/assets/js/116.9f058ff9.js"><link rel="prefetch" href="/myblog/assets/js/117.74b4d1ab.js"><link rel="prefetch" href="/myblog/assets/js/118.f2b06ce5.js"><link rel="prefetch" href="/myblog/assets/js/119.9bfa87e5.js"><link rel="prefetch" href="/myblog/assets/js/12.ca771795.js"><link rel="prefetch" href="/myblog/assets/js/120.fb5d2aa9.js"><link rel="prefetch" href="/myblog/assets/js/121.fe88a325.js"><link rel="prefetch" href="/myblog/assets/js/122.eccef6c4.js"><link rel="prefetch" href="/myblog/assets/js/123.ba2b4765.js"><link rel="prefetch" href="/myblog/assets/js/124.161ebae6.js"><link rel="prefetch" href="/myblog/assets/js/125.8e5dcd57.js"><link rel="prefetch" href="/myblog/assets/js/126.b47f3a54.js"><link rel="prefetch" href="/myblog/assets/js/127.cf8b5f49.js"><link rel="prefetch" href="/myblog/assets/js/128.3eac8aad.js"><link rel="prefetch" href="/myblog/assets/js/129.eb2a5f58.js"><link rel="prefetch" href="/myblog/assets/js/13.4ef0e3bd.js"><link rel="prefetch" href="/myblog/assets/js/130.073e078c.js"><link rel="prefetch" href="/myblog/assets/js/131.19e9c3fc.js"><link rel="prefetch" href="/myblog/assets/js/132.0ab369a6.js"><link rel="prefetch" href="/myblog/assets/js/133.5446262f.js"><link rel="prefetch" href="/myblog/assets/js/134.adda8bbb.js"><link rel="prefetch" href="/myblog/assets/js/135.ce645efe.js"><link rel="prefetch" href="/myblog/assets/js/136.f972cb33.js"><link rel="prefetch" href="/myblog/assets/js/137.ab0416fc.js"><link rel="prefetch" href="/myblog/assets/js/138.281a0ab6.js"><link rel="prefetch" href="/myblog/assets/js/139.57a01f7a.js"><link rel="prefetch" href="/myblog/assets/js/14.358408ff.js"><link rel="prefetch" href="/myblog/assets/js/140.82873882.js"><link rel="prefetch" href="/myblog/assets/js/141.373314b9.js"><link rel="prefetch" href="/myblog/assets/js/142.07bd16fa.js"><link rel="prefetch" href="/myblog/assets/js/143.bb3ad68f.js"><link rel="prefetch" href="/myblog/assets/js/144.8f88cfdd.js"><link rel="prefetch" href="/myblog/assets/js/145.bfe4c48f.js"><link rel="prefetch" href="/myblog/assets/js/146.daa780a4.js"><link rel="prefetch" href="/myblog/assets/js/147.15a77a40.js"><link rel="prefetch" href="/myblog/assets/js/148.8a165b83.js"><link rel="prefetch" href="/myblog/assets/js/149.e272f83e.js"><link rel="prefetch" href="/myblog/assets/js/15.ca637459.js"><link rel="prefetch" href="/myblog/assets/js/150.d8d8bc3d.js"><link rel="prefetch" href="/myblog/assets/js/151.47c1b7e9.js"><link rel="prefetch" href="/myblog/assets/js/152.43ac68ac.js"><link rel="prefetch" href="/myblog/assets/js/153.622d16fd.js"><link rel="prefetch" href="/myblog/assets/js/154.fef8d0fc.js"><link rel="prefetch" href="/myblog/assets/js/155.fc775ff2.js"><link rel="prefetch" href="/myblog/assets/js/156.f6c0ac46.js"><link rel="prefetch" href="/myblog/assets/js/157.0ccbbf40.js"><link rel="prefetch" href="/myblog/assets/js/158.4a6b3859.js"><link rel="prefetch" href="/myblog/assets/js/159.118216ab.js"><link rel="prefetch" href="/myblog/assets/js/16.cd03ef0c.js"><link rel="prefetch" href="/myblog/assets/js/160.0567146a.js"><link rel="prefetch" href="/myblog/assets/js/161.e822662f.js"><link rel="prefetch" href="/myblog/assets/js/162.b995bbd9.js"><link rel="prefetch" href="/myblog/assets/js/163.ffdd9647.js"><link rel="prefetch" href="/myblog/assets/js/164.051de827.js"><link rel="prefetch" href="/myblog/assets/js/165.3863dcc0.js"><link rel="prefetch" href="/myblog/assets/js/166.05c963db.js"><link rel="prefetch" href="/myblog/assets/js/167.921aeb03.js"><link rel="prefetch" href="/myblog/assets/js/168.e58898ce.js"><link rel="prefetch" href="/myblog/assets/js/169.e509a443.js"><link rel="prefetch" href="/myblog/assets/js/17.182fbb9a.js"><link rel="prefetch" href="/myblog/assets/js/170.4b7da5ec.js"><link rel="prefetch" href="/myblog/assets/js/171.96040766.js"><link rel="prefetch" href="/myblog/assets/js/172.5541aa4e.js"><link rel="prefetch" href="/myblog/assets/js/173.57ea7ff8.js"><link rel="prefetch" href="/myblog/assets/js/174.451d2089.js"><link rel="prefetch" href="/myblog/assets/js/175.7a2223a9.js"><link rel="prefetch" href="/myblog/assets/js/176.a586354a.js"><link rel="prefetch" href="/myblog/assets/js/177.52159158.js"><link rel="prefetch" href="/myblog/assets/js/178.695eb869.js"><link rel="prefetch" href="/myblog/assets/js/179.68a921c4.js"><link rel="prefetch" href="/myblog/assets/js/18.bf2c4529.js"><link rel="prefetch" href="/myblog/assets/js/180.752d7586.js"><link rel="prefetch" href="/myblog/assets/js/181.62f98ae1.js"><link rel="prefetch" href="/myblog/assets/js/182.32bfad58.js"><link rel="prefetch" href="/myblog/assets/js/183.dbe66daa.js"><link rel="prefetch" href="/myblog/assets/js/184.77251404.js"><link rel="prefetch" href="/myblog/assets/js/185.eb781e91.js"><link rel="prefetch" href="/myblog/assets/js/186.83cec49a.js"><link rel="prefetch" href="/myblog/assets/js/187.4c79a042.js"><link rel="prefetch" href="/myblog/assets/js/188.4224d6fc.js"><link rel="prefetch" href="/myblog/assets/js/189.0740b61e.js"><link rel="prefetch" href="/myblog/assets/js/19.35ce1ec9.js"><link rel="prefetch" href="/myblog/assets/js/190.ef2503e8.js"><link rel="prefetch" href="/myblog/assets/js/191.331d53b5.js"><link rel="prefetch" href="/myblog/assets/js/192.db318f55.js"><link rel="prefetch" href="/myblog/assets/js/193.e5308948.js"><link rel="prefetch" href="/myblog/assets/js/194.dcedbebd.js"><link rel="prefetch" href="/myblog/assets/js/195.5f345b5f.js"><link rel="prefetch" href="/myblog/assets/js/196.5decca86.js"><link rel="prefetch" href="/myblog/assets/js/197.19acb035.js"><link rel="prefetch" href="/myblog/assets/js/198.34b00332.js"><link rel="prefetch" href="/myblog/assets/js/199.ef44e1cb.js"><link rel="prefetch" href="/myblog/assets/js/20.be2877b4.js"><link rel="prefetch" href="/myblog/assets/js/200.0a3201bc.js"><link rel="prefetch" href="/myblog/assets/js/201.b470d40f.js"><link rel="prefetch" href="/myblog/assets/js/202.86b29368.js"><link rel="prefetch" href="/myblog/assets/js/203.503ef9df.js"><link rel="prefetch" href="/myblog/assets/js/204.792a605a.js"><link rel="prefetch" href="/myblog/assets/js/205.421b2307.js"><link rel="prefetch" href="/myblog/assets/js/206.11dde875.js"><link rel="prefetch" href="/myblog/assets/js/207.f18ac81e.js"><link rel="prefetch" href="/myblog/assets/js/208.694b3f59.js"><link rel="prefetch" href="/myblog/assets/js/209.bd21c4d2.js"><link rel="prefetch" href="/myblog/assets/js/21.832a5ddb.js"><link rel="prefetch" href="/myblog/assets/js/210.1490620d.js"><link rel="prefetch" href="/myblog/assets/js/211.be04207e.js"><link rel="prefetch" href="/myblog/assets/js/212.68e86dcf.js"><link rel="prefetch" href="/myblog/assets/js/213.21254c3b.js"><link rel="prefetch" href="/myblog/assets/js/214.262960d2.js"><link rel="prefetch" href="/myblog/assets/js/215.f6d035c2.js"><link rel="prefetch" href="/myblog/assets/js/216.b927f4d8.js"><link rel="prefetch" href="/myblog/assets/js/217.75bbb102.js"><link rel="prefetch" href="/myblog/assets/js/218.de019128.js"><link rel="prefetch" href="/myblog/assets/js/219.588c7cab.js"><link rel="prefetch" href="/myblog/assets/js/22.9e651ac0.js"><link rel="prefetch" href="/myblog/assets/js/220.7052426b.js"><link rel="prefetch" href="/myblog/assets/js/221.04d096f8.js"><link rel="prefetch" href="/myblog/assets/js/222.53c237f3.js"><link rel="prefetch" href="/myblog/assets/js/223.15232c4c.js"><link rel="prefetch" href="/myblog/assets/js/224.f205ce76.js"><link rel="prefetch" href="/myblog/assets/js/225.95db6d81.js"><link rel="prefetch" href="/myblog/assets/js/226.f4651247.js"><link rel="prefetch" href="/myblog/assets/js/227.fde11ece.js"><link rel="prefetch" href="/myblog/assets/js/228.0813b628.js"><link rel="prefetch" href="/myblog/assets/js/229.b0c5d4ed.js"><link rel="prefetch" href="/myblog/assets/js/23.2d9a0cb2.js"><link rel="prefetch" href="/myblog/assets/js/230.091142cf.js"><link rel="prefetch" href="/myblog/assets/js/231.41b0a826.js"><link rel="prefetch" href="/myblog/assets/js/232.a94d970b.js"><link rel="prefetch" href="/myblog/assets/js/233.a14dab10.js"><link rel="prefetch" href="/myblog/assets/js/234.a6aa36c0.js"><link rel="prefetch" href="/myblog/assets/js/235.89ef1699.js"><link rel="prefetch" href="/myblog/assets/js/236.405839c1.js"><link rel="prefetch" href="/myblog/assets/js/237.4f6ffde0.js"><link rel="prefetch" href="/myblog/assets/js/238.53607f04.js"><link rel="prefetch" href="/myblog/assets/js/239.2694db3b.js"><link rel="prefetch" href="/myblog/assets/js/24.09231540.js"><link rel="prefetch" href="/myblog/assets/js/240.8c900c48.js"><link rel="prefetch" href="/myblog/assets/js/241.5b3ad3a4.js"><link rel="prefetch" href="/myblog/assets/js/242.30a24282.js"><link rel="prefetch" href="/myblog/assets/js/243.fe4ef1d5.js"><link rel="prefetch" href="/myblog/assets/js/244.c98eeb21.js"><link rel="prefetch" href="/myblog/assets/js/245.f5e20fb7.js"><link rel="prefetch" href="/myblog/assets/js/246.d5bb1c4d.js"><link rel="prefetch" href="/myblog/assets/js/247.c8aadbc5.js"><link rel="prefetch" href="/myblog/assets/js/248.4568a9c5.js"><link rel="prefetch" href="/myblog/assets/js/249.a811d115.js"><link rel="prefetch" href="/myblog/assets/js/25.cd7c1de3.js"><link rel="prefetch" href="/myblog/assets/js/250.8aa4e3c5.js"><link rel="prefetch" href="/myblog/assets/js/251.a610e5db.js"><link rel="prefetch" href="/myblog/assets/js/252.43918c82.js"><link rel="prefetch" href="/myblog/assets/js/253.07e5ef05.js"><link rel="prefetch" href="/myblog/assets/js/254.1092b5aa.js"><link rel="prefetch" href="/myblog/assets/js/255.c3531452.js"><link rel="prefetch" href="/myblog/assets/js/256.d7052373.js"><link rel="prefetch" href="/myblog/assets/js/257.0d263bf0.js"><link rel="prefetch" href="/myblog/assets/js/258.2236ab0a.js"><link rel="prefetch" href="/myblog/assets/js/259.a342ea84.js"><link rel="prefetch" href="/myblog/assets/js/26.c82027e5.js"><link rel="prefetch" href="/myblog/assets/js/260.11619a30.js"><link rel="prefetch" href="/myblog/assets/js/261.8d846706.js"><link rel="prefetch" href="/myblog/assets/js/262.5c5cddf9.js"><link rel="prefetch" href="/myblog/assets/js/27.83a503b9.js"><link rel="prefetch" href="/myblog/assets/js/28.2eabd502.js"><link rel="prefetch" href="/myblog/assets/js/29.7b6431b8.js"><link rel="prefetch" href="/myblog/assets/js/30.fb5f9a64.js"><link rel="prefetch" href="/myblog/assets/js/31.35615735.js"><link rel="prefetch" href="/myblog/assets/js/32.844d892b.js"><link rel="prefetch" href="/myblog/assets/js/33.48b26807.js"><link rel="prefetch" href="/myblog/assets/js/34.d09d4078.js"><link rel="prefetch" href="/myblog/assets/js/35.4c0dd015.js"><link rel="prefetch" href="/myblog/assets/js/36.a1a1b822.js"><link rel="prefetch" href="/myblog/assets/js/37.2f23275d.js"><link rel="prefetch" href="/myblog/assets/js/38.986d342c.js"><link rel="prefetch" href="/myblog/assets/js/39.c56b139a.js"><link rel="prefetch" href="/myblog/assets/js/4.ec0d8765.js"><link rel="prefetch" href="/myblog/assets/js/40.ebacb120.js"><link rel="prefetch" href="/myblog/assets/js/41.36775753.js"><link rel="prefetch" href="/myblog/assets/js/42.c0fad150.js"><link rel="prefetch" href="/myblog/assets/js/43.6832fd04.js"><link rel="prefetch" href="/myblog/assets/js/44.65c90495.js"><link rel="prefetch" href="/myblog/assets/js/45.783921a4.js"><link rel="prefetch" href="/myblog/assets/js/46.c439c54f.js"><link rel="prefetch" href="/myblog/assets/js/47.a29e1714.js"><link rel="prefetch" href="/myblog/assets/js/48.83d8a674.js"><link rel="prefetch" href="/myblog/assets/js/49.72cd2d17.js"><link rel="prefetch" href="/myblog/assets/js/5.ed4d9ce4.js"><link rel="prefetch" href="/myblog/assets/js/50.54019b13.js"><link rel="prefetch" href="/myblog/assets/js/51.1e6e70e5.js"><link rel="prefetch" href="/myblog/assets/js/52.401d1b77.js"><link rel="prefetch" href="/myblog/assets/js/53.52fdc3d3.js"><link rel="prefetch" href="/myblog/assets/js/54.3de953df.js"><link rel="prefetch" href="/myblog/assets/js/55.caa454a9.js"><link rel="prefetch" href="/myblog/assets/js/56.14541cdc.js"><link rel="prefetch" href="/myblog/assets/js/57.1cb455c7.js"><link rel="prefetch" href="/myblog/assets/js/58.dfe2e36f.js"><link rel="prefetch" href="/myblog/assets/js/59.5213237e.js"><link rel="prefetch" href="/myblog/assets/js/6.d73355cf.js"><link rel="prefetch" href="/myblog/assets/js/60.1efa97c8.js"><link rel="prefetch" href="/myblog/assets/js/61.e8f5614c.js"><link rel="prefetch" href="/myblog/assets/js/62.85230af2.js"><link rel="prefetch" href="/myblog/assets/js/63.7eb3be5c.js"><link rel="prefetch" href="/myblog/assets/js/64.915bea5d.js"><link rel="prefetch" href="/myblog/assets/js/65.32df97aa.js"><link rel="prefetch" href="/myblog/assets/js/66.62f1d7ce.js"><link rel="prefetch" href="/myblog/assets/js/67.11713af3.js"><link rel="prefetch" href="/myblog/assets/js/68.a05d5de9.js"><link rel="prefetch" href="/myblog/assets/js/69.9b2f3cea.js"><link rel="prefetch" href="/myblog/assets/js/70.128131c4.js"><link rel="prefetch" href="/myblog/assets/js/71.b87a34b7.js"><link rel="prefetch" href="/myblog/assets/js/72.475b8404.js"><link rel="prefetch" href="/myblog/assets/js/73.bf9de393.js"><link rel="prefetch" href="/myblog/assets/js/74.a31e9a94.js"><link rel="prefetch" href="/myblog/assets/js/75.9aa581b3.js"><link rel="prefetch" href="/myblog/assets/js/76.cab09666.js"><link rel="prefetch" href="/myblog/assets/js/77.3f1d4dd2.js"><link rel="prefetch" href="/myblog/assets/js/78.aa1fe6ed.js"><link rel="prefetch" href="/myblog/assets/js/79.505e90b6.js"><link rel="prefetch" href="/myblog/assets/js/80.53d7bda0.js"><link rel="prefetch" href="/myblog/assets/js/81.3437f7ae.js"><link rel="prefetch" href="/myblog/assets/js/82.5d50915a.js"><link rel="prefetch" href="/myblog/assets/js/83.ddcc784a.js"><link rel="prefetch" href="/myblog/assets/js/84.96e3c9d0.js"><link rel="prefetch" href="/myblog/assets/js/85.0ec95954.js"><link rel="prefetch" href="/myblog/assets/js/86.2b77f6fc.js"><link rel="prefetch" href="/myblog/assets/js/87.eee579fb.js"><link rel="prefetch" href="/myblog/assets/js/88.4a299330.js"><link rel="prefetch" href="/myblog/assets/js/89.f170acd9.js"><link rel="prefetch" href="/myblog/assets/js/9.76d301fc.js"><link rel="prefetch" href="/myblog/assets/js/90.df22d43f.js"><link rel="prefetch" href="/myblog/assets/js/91.f754989b.js"><link rel="prefetch" href="/myblog/assets/js/92.c747ccfc.js"><link rel="prefetch" href="/myblog/assets/js/93.9ef56811.js"><link rel="prefetch" href="/myblog/assets/js/95.dfced44d.js"><link rel="prefetch" href="/myblog/assets/js/96.ebe891cd.js"><link rel="prefetch" href="/myblog/assets/js/97.0da9844c.js"><link rel="prefetch" href="/myblog/assets/js/98.f0a7b210.js"><link rel="prefetch" href="/myblog/assets/js/99.e6125bec.js"><link rel="prefetch" href="/myblog/assets/js/vendors~docsearch.31918a42.js">
    <link rel="stylesheet" href="/myblog/assets/css/0.styles.c5ea190f.css">
  </head>
  <body class="theme-mode-light">
    <div id="app" data-server-rendered="true"><div class="theme-container sidebar-open have-rightmenu"><header class="navbar blur"><div title="目录" class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/myblog/" class="home-link router-link-active"><img src="/myblog/img/logo.png" alt="ZYG's blog" class="logo"> <span class="site-name can-hide">ZYG's blog</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/myblog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/myblog/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/d71a6d/" class="nav-link">JVM</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/e9f21d/" class="nav-link">Java语言基础</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/ce8312/" class="nav-link">JavaWeb</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/a4834e/" class="nav-link">Spring框架</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><a href="/myblog/DataBase/" class="link-title">数据库</a> <span class="title" style="display:none;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/3a3a84/" class="nav-link">MySQL</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><a href="/myblog/CS-Basics/" class="link-title">计算机基础</a> <span class="title" style="display:none;">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/b3c563/" class="nav-link">计算机组成原理</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/98f8f4/" class="nav-link">计算机网络</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/606700/" class="nav-link">算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Linux" class="dropdown-title"><a href="/myblog/Linux/" class="link-title">Linux</a> <span class="title" style="display:none;">Linux</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/044e10/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/521b3b/" class="nav-link">Linux</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><a href="/myblog/middleware/" class="link-title">中间件</a> <span class="title" style="display:none;">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/aac218/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/6507cf/" class="nav-link">Kafka</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它组件" class="dropdown-title"><a href="/myblog/other-wares/" class="link-title">其它组件</a> <span class="title" style="display:none;">其它组件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/b5c3ce/" class="nav-link">日志框架</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/ccf2f8/" class="nav-link">常用工具</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/ac5bb2/" class="nav-link">工作流</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/994ca0/" class="nav-link">加密与安全</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/myblog/front-end/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/9b90ca/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/d1ec3d/" class="nav-link">博客部署教程</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/0e0348/" class="nav-link">nginx</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="优秀教程" class="dropdown-title"><a href="/myblog/tutorial/" class="link-title">优秀教程</a> <span class="title" style="display:none;">优秀教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/mall-tutorial/" class="nav-link">mall教程</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它" class="dropdown-title"><a href="/myblog/others/" class="link-title">其它</a> <span class="title" style="display:none;">其它</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/c736ca/" class="nav-link">疑难杂症解决办法</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/ef6421/" class="nav-link">待解决问题</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="架构设计" class="dropdown-title"><a href="/myblog/architecture/" class="link-title">架构设计</a> <span class="title" style="display:none;">架构设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/182ba1/" class="nav-link">架构设计入门</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/d8c29b/" class="nav-link">设计模式</a></li></ul></div></div><div class="nav-item"><a href="https://zyg525.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  旧博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/zyg525/myblog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav></div></header> <div class="sidebar-mask"></div> <div class="sidebar-hover-trigger"></div> <aside class="sidebar" style="display:none;"><div class="blogger"><img src="/myblog/img/logo.png"> <div class="blogger-info"><h3>zyg</h3> <span>(○'◡'○)</span></div></div> <nav class="nav-links"><div class="nav-item"><a href="/myblog/" class="nav-link">首页</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Java" class="dropdown-title"><a href="/myblog/java/" class="link-title">Java</a> <span class="title" style="display:none;">Java</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/d71a6d/" class="nav-link">JVM</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/e9f21d/" class="nav-link">Java语言基础</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/ce8312/" class="nav-link">JavaWeb</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/a4834e/" class="nav-link">Spring框架</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="数据库" class="dropdown-title"><a href="/myblog/DataBase/" class="link-title">数据库</a> <span class="title" style="display:none;">数据库</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/3a3a84/" class="nav-link">MySQL</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="计算机基础" class="dropdown-title"><a href="/myblog/CS-Basics/" class="link-title">计算机基础</a> <span class="title" style="display:none;">计算机基础</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/b3c563/" class="nav-link">计算机组成原理</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/98f8f4/" class="nav-link">计算机网络</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/606700/" class="nav-link">算法</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="Linux" class="dropdown-title"><a href="/myblog/Linux/" class="link-title">Linux</a> <span class="title" style="display:none;">Linux</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/044e10/" class="nav-link">Docker</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/521b3b/" class="nav-link">Linux</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="中间件" class="dropdown-title"><a href="/myblog/middleware/" class="link-title">中间件</a> <span class="title" style="display:none;">中间件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/aac218/" class="nav-link">Redis</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/6507cf/" class="nav-link">Kafka</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它组件" class="dropdown-title"><a href="/myblog/other-wares/" class="link-title">其它组件</a> <span class="title" style="display:none;">其它组件</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/b5c3ce/" class="nav-link">日志框架</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/ccf2f8/" class="nav-link">常用工具</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/ac5bb2/" class="nav-link">工作流</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/994ca0/" class="nav-link">加密与安全</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="前端" class="dropdown-title"><a href="/myblog/front-end/" class="link-title">前端</a> <span class="title" style="display:none;">前端</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/9b90ca/" class="nav-link">Nodejs</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/d1ec3d/" class="nav-link">博客部署教程</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/0e0348/" class="nav-link">nginx</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="优秀教程" class="dropdown-title"><a href="/myblog/tutorial/" class="link-title">优秀教程</a> <span class="title" style="display:none;">优秀教程</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/mall-tutorial/" class="nav-link">mall教程</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="其它" class="dropdown-title"><a href="/myblog/others/" class="link-title">其它</a> <span class="title" style="display:none;">其它</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/c736ca/" class="nav-link">疑难杂症解决办法</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/ef6421/" class="nav-link">待解决问题</a></li></ul></div></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="架构设计" class="dropdown-title"><a href="/myblog/architecture/" class="link-title">架构设计</a> <span class="title" style="display:none;">架构设计</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><!----> <a href="/myblog/pages/182ba1/" class="nav-link">架构设计入门</a></li><li class="dropdown-item"><!----> <a href="/myblog/pages/d8c29b/" class="nav-link">设计模式</a></li></ul></div></div><div class="nav-item"><a href="https://zyg525.github.io/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  旧博客
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <a href="https://github.com/zyg525/myblog" target="_blank" rel="noopener noreferrer" class="repo-link">
    GitHub
    <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></nav>  <ul class="sidebar-links"><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading open"><span>Redis</span> <span class="arrow down"></span></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/myblog/pages/aac218/" class="sidebar-link">Redis教程</a></li><li><a href="/myblog/pages/8df07e/" class="sidebar-link">SpringBoot集成Redis</a></li><li><a href="/myblog/pages/4f6a21/" aria-current="page" class="active sidebar-link">Redis缓存问题</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level2"><a href="/myblog/pages/4f6a21/#基本理论" class="sidebar-link">基本理论</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/myblog/pages/4f6a21/#cap原则" class="sidebar-link">CAP原则</a></li><li class="sidebar-sub-header level3"><a href="/myblog/pages/4f6a21/#base理论" class="sidebar-link">BASE理论</a></li><li class="sidebar-sub-header level3"><a href="/myblog/pages/4f6a21/#原理" class="sidebar-link">原理</a></li><li class="sidebar-sub-header level3"><a href="/myblog/pages/4f6a21/#base理论和acid理论" class="sidebar-link">BASE理论和ACID理论</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/myblog/pages/4f6a21/#redis缓存一致性解决方案" class="sidebar-link">Redis缓存一致性解决方案</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/myblog/pages/4f6a21/#基本原则" class="sidebar-link">基本原则</a></li><li class="sidebar-sub-header level3"><a href="/myblog/pages/4f6a21/#cache-aside-旁路缓存" class="sidebar-link">Cache-Aside(旁路缓存)</a></li><li class="sidebar-sub-header level3"><a href="/myblog/pages/4f6a21/#如何保证缓存删除成功" class="sidebar-link">如何保证缓存删除成功</a></li><li class="sidebar-sub-header level3"><a href="/myblog/pages/4f6a21/#read-through、write-through、write-behind" class="sidebar-link">Read Through、Write Through、Write Behind</a></li></ul></li><li class="sidebar-sub-header level2"><a href="/myblog/pages/4f6a21/#redis缓存失效解决方案" class="sidebar-link">Redis缓存失效解决方案</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header level3"><a href="/myblog/pages/4f6a21/#缓存穿透" class="sidebar-link">缓存穿透</a></li><li class="sidebar-sub-header level3"><a href="/myblog/pages/4f6a21/#缓存击穿" class="sidebar-link">缓存击穿</a></li><li class="sidebar-sub-header level3"><a href="/myblog/pages/4f6a21/#缓存雪崩" class="sidebar-link">缓存雪崩</a></li></ul></li></ul></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>Kafka</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <div><main class="page"><div class="theme-vdoing-wrapper "><div class="articleInfo-wrap" data-v-06225672><div class="articleInfo" data-v-06225672><ul class="breadcrumbs" data-v-06225672><li data-v-06225672><a href="/myblog/" title="首页" class="iconfont icon-home router-link-active" data-v-06225672></a></li> <li data-v-06225672><a href="/myblog/middleware/#中间件" data-v-06225672>中间件</a></li><li data-v-06225672><a href="/myblog/middleware/#Redis" data-v-06225672>Redis</a></li></ul> <div class="info" data-v-06225672><div title="作者" class="author iconfont icon-touxiang" data-v-06225672><a href="https://github.com/zyg525" target="_blank" title="作者" class="beLink" data-v-06225672>zyg</a></div> <div title="创建时间" class="date iconfont icon-riqi" data-v-06225672><a href="javascript:;" data-v-06225672>2024-03-30</a></div> <!----></div></div></div> <!----> <div class="content-wrapper"><div class="right-menu-wrapper"><div class="right-menu-margin"><div class="right-menu-title">目录</div> <div class="right-menu-content"></div></div></div> <h1><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAAAAXNSR0IArs4c6QAABGpJREFUSA3tVVtoXFUU3fvOI53UlmCaKIFmwEhsE7QK0ipFEdHEKpXaZGrp15SINsXUWvBDpBgQRKi0+KKoFeJHfZA+ED9KKoIU2gYD9UejTW4rVIzm0VSTziPzuNu1z507dibTTjL4U/DAzLn3nL3X2o91ziX6f9wMFdh6Jvbm9nNSV0msViVO6tN1Rm7NMu2OpeJ9lWBUTDxrJbYTS0hInuwciu9eLHlFxCLCZEk3MegsJmZ5K/JD6t7FkFdEvGUo1g7qJoG3MHImqRIn8/nzY1K9UPKKiJmtnUqHVE3Gbuay6vJE/N2FEmuxFjW2nUuE0yQXRRxLiTUAzs36zhZvOXJPdX850EVnnLZkB8prodQoM5JGj7Xk2mvC7JB8tG04Ef5PiXtG0UtxupRQSfTnBoCy554x18yJHI6I+G5Eru4LHmPJZEQsrvPUbMiA8G/WgMK7w7I+ez7++o2ANfbrjvaOl1tFMs+htG3IrZH9/hDX1Pr8Tc0UvH8tcX29KzAgIGcEkINyW5BF9x891hw6VYqgJHEk0huccS7vh3C6gTiODL+26huuBtbct8eZnqLML8PkxGYpuPZBqtqwkSjgc4mB5gbgig5i+y0UDK35LMxXisn9xQtK+nd26gTIHsHe/oblK/b29fUmN/8Y+9jAQrnBp56m1LcDlDp9irKTExSKduXJVWSqdBMA08pEJnEIOB3FPPMybu/oeV8zFeYN3xx576Q6RH+VmplE4ncQV5v+5rzSoyOU7PuEAg8g803PwBJ0CExno/jcMbN8tONYeOmHiuUNryvm3fRUy4tMPVLdAGkUhNWuggGrJcXPv+ouCjz0MKUHz1J2/E8IC9nqTabcxgaBYM0hPhD5Y65FsbxRQKxCQrDjDctW7PUM3HuZunFyifSAqEfuzCp48Il24luWUWZoyJCaPR82jE0+kFA643wRFVni4RYSq3ohJO2pZ7B5dO4xkDWbEpossJPLSrPjYID8rS2UHTlvyNxqIGsg674XJJ7vnh5L7PNwC4hh2sjCI96mzszOTpxLF0T7l88Yz7lAuK6OnL8gXLOnTvpzSb22YG8W7us3jSebFHeeqnXRG1vt+MoUM84LQIBmMsCTAcOauTh0T0l0neQK7m2bLMt2mGxU3HYssS0J2cdv5wljlPsrIuZLAG/2DOZIXgCYT8uMGZN+e2kSirfxZOPCsC0f24nTZzspnVn9VePS1Z5vubmAGGXG8ZFno9Hel0yfA5ZPhF7Dh972BQJ2qCpgH67lmWtBYbvk6sz02wjky2vXyz0XErP/kFB619js1BtwfOV4OPRqOQBjy3Qbk18vigUPPSD5ceHnwck7W9bhAqZdd7SuG7w4/P2F/GaJh8c7e9qgow+Q7cGBo+98WsLkuktFqiZabtXuQTu/Y5ETbR0v7tNSFnvrmu6pjdoan2KjMu8q/Hmj1EfCO2ZGfEIbIXKUlw8qaX9/b2oeSJmFksSeT/Fn0V3nSypChh4Gjh74ybO9aeZ/AN2dwciu2/MhAAAAAElFTkSuQmCC">Redis缓存问题<!----></h1>  <div class="theme-vdoing-content content__default"><h2 id="基本理论"><a href="#基本理论" class="header-anchor">#</a> 基本理论</h2> <h3 id="cap原则"><a href="#cap原则" class="header-anchor">#</a> CAP原则</h3> <p>CAP原则指的是，在一个分布式系统中，以下三个原则中最多只能满足两个：</p> <p><strong>1、一致性(Consistency)；</strong></p> <p><strong>2、可用性(Availability)；</strong></p> <p><strong>3、分区容错性(Partition tolerance)。</strong></p> <h3 id="base理论"><a href="#base理论" class="header-anchor">#</a> BASE理论</h3> <ul><li><h3 id="原理"><a href="#原理" class="header-anchor">#</a> 原理</h3></li></ul> <p>BASE理论是<code>Basically Available</code>(<strong>基本可用</strong>)、<code>Soft State</code>(<strong>软状态</strong>)、<code>Eventually Consistent</code>(<strong>最终一致性</strong>)三个短语的缩写。BASE理论是对CAP原则中一致性和可用性权衡的结果，其来源于对大规模互联网分布式系统实践的总结，是基于CAP原则逐步演化而来。更具体地说，<strong>BASE理论是对 CAP 中 AP 方案的一个补充。其基本思路就是：通过业务，牺牲强一致性而获得可用性，允许数据在一段时间内是不一致的，但是最终要达到一致性状态。</strong></p> <p>BASE理论的解释如下：</p> <p><strong>1、基本可用(Basically Available)</strong>：分布式系统在出现不可预知故障的时候，<strong>允许损失部分可用性</strong>，比如响应时间可能会变长，功能可能会降级。</p> <p><strong>2、软状态(Soft State)</strong>：软状态也称为弱状态，和硬状态相对，是指允许系统中的数据存在中间状态，并认为该中间状态的存在不会影响系统的整体可用性，即<strong>允许系统在不同节点的数据副本之间进行数据同步的过程存在延时</strong>。</p> <p><strong>3、最终一致性(Eventually Consistent)</strong>：最终一致性强调的是系统中所有的数据副本，在经过一段时间的同步后，最终能够达到一个一致的状态。因此，<strong>最终一致性的本质是需要系统保证最终数据能够达到一致，而不需要实时保证系统数据的强一致性</strong>。</p> <ul><li><h3 id="base理论和acid理论"><a href="#base理论和acid理论" class="header-anchor">#</a> BASE理论和ACID理论</h3></li></ul> <p>ACID 是传统数据库常用的设计理念，追求强一致性模型。BASE 支持的是大型分布式系统，提出通过牺牲强一致性获得高可用。ACID 和 BASE 代表了两种截然相反的设计哲学，在分布式系统设计的场景中，系统组件对一致性要求是不同的，因此 ACID 和 BASE 又会结合使用。</p> <h2 id="redis缓存一致性解决方案"><a href="#redis缓存一致性解决方案" class="header-anchor">#</a> Redis缓存一致性解决方案</h2> <h3 id="基本原则"><a href="#基本原则" class="header-anchor">#</a> 基本原则</h3> <p>Redis缓存是BASE理论的一个典型应用。Redis缓存和数据库相当于存放数据的两个节点，为了保证系统的可用性，需要牺牲一部分的一致性，也就是说，<strong>Redis缓存和数据库允许短时间内数据不一致，但是最终要达到一致，这是各种Redis缓存方案所遵循的一个基本原则。</strong></p> <h3 id="cache-aside-旁路缓存"><a href="#cache-aside-旁路缓存" class="header-anchor">#</a> Cache-Aside(旁路缓存)</h3> <p>所谓旁路缓存，就是<strong>读取缓存、读取数据库和更新缓存的操作都由应用系统来完成</strong>，是业务系统最常用的缓存策略。</p> <p>旁路缓存的方案有四种，分别是：</p> <p>1、更新数据库的同时更新缓存，但是先更新缓存，再更新数据库；</p> <p>2、更新数据库的同时更新缓存，但是先更新数据库，再更新缓存；</p> <p>3、更新数据库的同时删除缓存，先删除缓存，再更新数据库，查询时再更新缓存；</p> <p>4、更新数据库的同时删除缓存，先更新数据库，再删除缓存，查询时再更新缓存。</p> <p>方案1、2的缺点是：</p> <p>1、在多个请求并发更新数据时，由于更新数据库和更新缓存这两步不能构成一个原子操作，因此很容易导致缓存和数据库最终不一致。解决办法有两个，一是给更新操作加分布式锁，保证同一时刻只有一个请求可以更新，但这些会降低写入的性能，二是给缓存设置较短的过期时间，保证最终的一致性；</p> <p>2、更新后的缓存很可能会长时间不被访问，如果每次更新数据库时都更新缓存，很可能造成资源浪费，更好的方法是更新数据库时删除缓存，等到查询数据时再更新缓存，这是<code>lazy-loading</code>思想的一种体现。</p> <p>方案1、2的优点是：</p> <p>1、由于缓存不会被删除，因此缓存的命中率很高。</p> <p>方案3、4解决了并发更新导致的数据不一致问题，但因为要删除缓存，所以缓存命中率相对低一点。</p> <p>方案3的缺点是：</p> <p>1、由于更新数据库的速度比更新缓存慢很多，因此当更新请求和查询请求并发执行时，如果在删除缓存和更新数据库之间，查询请求用数据库中的旧数据更新了缓存，就会导致数据库和缓存最终不一致。</p> <p>为了解决方案3的这个问题，可以采用延迟双删的方法，更新数据的伪代码如下：</p> <div class="language-java line-numbers-mode"><pre class="language-java"><code><span class="token comment">// 先删除缓存</span>
redis<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 再更新数据库</span>
mysql<span class="token punctuation">.</span><span class="token function">update</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 等待查询请求中的更新缓存操作执行完成后，再删除缓存</span>
<span class="token class-name">Thread</span><span class="token punctuation">.</span><span class="token function">sleep</span><span class="token punctuation">(</span>n<span class="token punctuation">)</span><span class="token punctuation">;</span>
redis<span class="token punctuation">.</span><span class="token function">delete</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><p>方案4也可能会出现缓存和数据库的最终不一致，但几率很小，仅限于下面的情况：查询请求执行时缓存刚好过期，在它更新完缓存之前，更新请求完成了更新数据库、删除缓存的操作，我们知道更新数据库比更新缓存慢很多，因此这种情况出现的概率很低，但是为了避免发生极端情况，最好给缓存加上过期时间。</p> <p>Cache-Aside的四种缓存方案总结如下表所示：</p> <table><thead><tr><th></th> <th>更新数据库时更新缓存</th> <th>先删除缓存、再更新数据库，查询时更新缓存</th> <th>先更新数据库、再删除缓存，查询时更新缓存</th></tr></thead> <tbody><tr><td><strong>优点</strong></td> <td>1、缓存命中率高</td> <td>1、使用懒加载的思想，节约了性能</td> <td>1、使用懒加载的思想，节约了性能；<br>2、发生缓存和数据库不一致的可能性很小。</td></tr> <tr><td><strong>缺点</strong></td> <td>1、有较大可能发生缓存和数据库最终不一致；<br>2、缓存更新后很可能不会使用，造成性能浪费。</td> <td>1、缓存命中率低；<br>2、有较大可能发生缓存和数据库最终不一致。</td> <td>1、缓存命中率低</td></tr> <tr><td><strong>如何保证最终一致性</strong></td> <td>1、对更新操作加分布式锁，保证同一时刻只有一个更新操作，但会降低写入性能；<br>2、给缓存设置较短的过期时间。</td> <td>1、延迟双删；<br>2、给缓存设置过期时间。</td> <td>1、给缓存设置过期时间</td></tr></tbody></table> <p><strong>基于上面的原因，推荐使用先更新数据库、再删除缓存，查询时更新缓存，给缓存设置过期时间作为兜底的方案。</strong></p> <h3 id="如何保证缓存删除成功"><a href="#如何保证缓存删除成功" class="header-anchor">#</a> 如何保证缓存删除成功</h3> <p>在第4种方案中，需要保证缓存能够删除成功，如果缓存删除失败，会导致缓存和数据库最终不一致。</p> <p>保证缓存能够删除成功的方法主要有两个：</p> <p>1、引入消息队列，将要删除的缓存数据放入消息队列，让消费者去删除缓存。如果删除缓存失败，可以从消息队列中重新获取数据，然后再次删除缓存，这就是重试机制。如果超过一定的重试次数还没有删除成功，就向业务层发送报错信息。如果删除成功，就从消息队列中移除缓存数据。</p> <p>2、先更新数据库，再删缓存的策略的第一步是更新数据库，那么更新数据库成功，就会产生一条变更日志，记录在 binlog 里。于是我们就可以通过订阅 binlog 日志，拿到具体要操作的数据，然后再执行缓存删除，阿里巴巴开源的 Canal 中间件就是基于这个实现的。Canal 模拟 MySQL 主从复制的交互协议，把自己伪装成一个 MySQL 的从节点，向 MySQL 主节点发送 dump 请求，MySQL 收到请求后，就会开始推送 Binlog 给 Canal，Canal 解析 Binlog 字节流之后，转换为便于读取的结构化数据，供下游程序订阅使用。</p> <p></p> <h3 id="read-through、write-through、write-behind"><a href="#read-through、write-through、write-behind" class="header-anchor">#</a> Read Through、Write Through、Write Behind</h3> <p>Read Through 套路就是在查询操作中更新缓存，也就是说，当缓存失效的时候（过期或LRU换出），Cache Aside是由调用方负责把数据加载入缓存，而Read Through则用缓存服务自己来加载，从而对应用方是透明的。</p> <p>Write Through 套路和Read Through相仿，不过是在更新数据时发生。当有数据更新的时候，如果没有命中缓存，直接更新数据库，然后返回。如果命中了缓存，则更新缓存，然后再由Cache自己更新数据库（这是一个同步操作）。</p> <p>Write Behind 又叫 Write Back。<strong>一些了解Linux操作系统内核的同学对write back应该非常熟悉，这不就是Linux文件系统的Page Cache的算法吗？是的，你看基础这玩意全都是相通的</strong>。所以，基础很重要，我已经不是一次说过基础很重要这事了。</p> <p>Write Back套路，一句说就是，在更新数据的时候，只更新缓存，不更新数据库，而我们的缓存会异步地批量更新数据库。这个设计的好处就是让数据的I/O操作飞快无比（因为直接操作内存嘛 ），因为异步，write backg还可以合并对同一个数据的多次操作，所以性能的提高是相当可观的。</p> <p>但是，其带来的问题是，数据不是强一致性的，而且可能会丢失（我们知道Unix/Linux非正常关机会导致数据丢失，就是因为这个事）。在软件设计上，我们基本上不可能做出一个没有缺陷的设计，就像算法设计中的时间换空间，空间换时间一个道理，有时候，强一致性和高性能，高可用和高性性是有冲突的。软件设计从来都是取舍Trade-Off。</p> <p>另外，Write Back实现逻辑比较复杂，因为他需要track有哪数据是被更新了的，需要刷到持久层上。操作系统的write back会在仅当这个cache需要失效的时候，才会被真正持久起来，比如，内存不够了，或是进程退出了等情况，这又叫lazy write。</p> <p>引用自：<a href="https://coolshell.cn/articles/17416.html" target="_blank" rel="noopener noreferrer">缓存更新的套路<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></p> <h2 id="redis缓存失效解决方案"><a href="#redis缓存失效解决方案" class="header-anchor">#</a> Redis缓存失效解决方案</h2> <h3 id="缓存穿透"><a href="#缓存穿透" class="header-anchor">#</a> 缓存穿透</h3> <p>缓存穿透指的是用户访问的数据在缓存和数据库中都不存在，导致无法建立缓存，请求会一直访问数据库，如果请求数量很大时，就会给数据库造成压力。</p> <p>缓存穿透的解决办法有三种：</p> <p>1、在程序入口处对请求参数进行验证，过滤掉恶意的请求；</p> <p>2、在请求到达缓存之前，使用布隆过滤器过滤掉数据库中不存在的数据，由于布隆过滤器存在一定误判概率，剩下的数据有一小部分是数据库中不存在的数据；</p> <p>3、将数据库中不存在的数据存入缓存，值设置为<code>&quot;null&quot;</code>，同时设置过期时间，这样当缓存建立起来，这些请求就不会直接访问数据库了。</p> <h3 id="缓存击穿"><a href="#缓存击穿" class="header-anchor">#</a> 缓存击穿</h3> <p>缓存击穿指的是缓存中的某个key突然过期，此时如果有大量的请求查询这个key，会直接访问数据库，给数据库造成压力。</p> <p>缓存击穿的解决办法有：</p> <p>1、设置热点数据永不过期；</p> <p>2、为缓存设置逻辑过期时间，当缓存逻辑过期时，直接返回过期数据，然后新开一个独立线程来重建缓存，重建缓存的操作使用互斥锁进行保护，保证同一时刻只能有一个线程在重建缓存，互斥锁要设置超时时间，防止出现锁长时间被占用的情况。这种方法虽然会导致缓存和数据库短时间的不一致，但并发性能较高。</p> <h3 id="缓存雪崩"><a href="#缓存雪崩" class="header-anchor">#</a> 缓存雪崩</h3> <p>缓存雪崩和缓存击穿比较类似，它指的是缓存中大量key同时过期，此时如果有大量的请求查询这些key，会直接访问数据库，给数据库造成压力。</p> <p>缓存雪崩的解决办法，除了包括缓存击穿的解决办法外，还有一条：</p> <p>1、为这些key设置随机过期时间，防止同时过期。</p></div></div>  <div class="page-edit"><div class="edit-link"><a href="https://github.com/zyg525/myblog/edit/master/docs/05.中间件/01.Redis/03.Redis缓存问题.md" target="_blank" rel="noopener noreferrer">编辑</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <div class="tags"><a href="/myblog/tags/?tag=%E6%95%B0" title="标签">#数</a><a href="/myblog/tags/?tag=%E6%8D%AE" title="标签">#据</a><a href="/myblog/tags/?tag=%E5%BA%93" title="标签">#库</a></div> <div class="last-updated"><span class="prefix">上次更新:</span> <span class="time">2024/03/31, 17:45:04</span></div></div> <div class="page-nav-wapper"><div class="page-nav-centre-wrap"><a href="/myblog/pages/8df07e/" class="page-nav-centre page-nav-centre-prev"><div class="tooltip">SpringBoot集成Redis</div></a> <a href="/myblog/pages/6507cf/" class="page-nav-centre page-nav-centre-next"><div class="tooltip">Kafka教程</div></a></div> <div class="page-nav"><p class="inner"><span class="prev">
        ←
        <a href="/myblog/pages/8df07e/" class="prev">SpringBoot集成Redis</a></span> <span class="next"><a href="/myblog/pages/6507cf/">Kafka教程</a>→
      </span></p></div></div></div> <div class="article-list"><div class="article-title"><a href="/myblog/archives/" class="iconfont icon-bi">最近更新</a></div> <div class="article-wrapper"><dl><dd>01</dd> <dt><a href="/myblog/pages/4f80ec/"><div>
            MyBatis-Plus教程
            <!----></div></a> <span class="date">06-21</span></dt></dl><dl><dd>02</dd> <dt><a href="/myblog/pages/606700/"><div>
            算法的时间复杂度和空间复杂度
            <!----></div></a> <span class="date">02-10</span></dt></dl><dl><dd>03</dd> <dt><a href="/myblog/pages/574a30/"><div>
            牛客面试必刷TOP101
            <!----></div></a> <span class="date">02-04</span></dt></dl> <dl><dd></dd> <dt><a href="/myblog/archives/" class="more">更多文章&gt;</a></dt></dl></div></div></main></div> <div class="footer"><div class="icons"><a href="1213630438@qq.com" title="发邮件" target="_blank" class="iconfont icon-youjian"></a><a href="https://github.com/zyg525" title="GitHub" target="_blank" class="iconfont icon-github"></a><a href="https://music.163.com/playlist?id=123007714&amp;userid=102483138" title="听音乐" target="_blank" class="iconfont icon-erji"></a></div> 
  Theme by
  <a href="https://github.com/xugaoyi/vuepress-theme-vdoing" target="_blank" title="本站主题">Vdoing</a> 
    | Copyright © 2024-2025
    <span>ZYG | <a href="https://github.com/zyg525/myblog/blob/master/LICENSE" target="_blank">MIT License</a></span></div> <div class="buttons"><div title="返回顶部" class="button blur go-to-top iconfont icon-fanhuidingbu" style="display:none;"></div> <div title="去评论" class="button blur go-to-comment iconfont icon-pinglun" style="display:none;"></div> <div title="主题模式" class="button blur theme-mode-but iconfont icon-zhuti"><ul class="select-box" style="display:none;"><li class="iconfont icon-zidong">
          跟随系统
        </li><li class="iconfont icon-rijianmoshi">
          浅色模式
        </li><li class="iconfont icon-yejianmoshi">
          深色模式
        </li><li class="iconfont icon-yuedu">
          阅读模式
        </li></ul></div></div> <!----> <!----> <!----></div><div class="global-ui"><div></div></div></div>
    <script src="/myblog/assets/js/app.5079fcf9.js" defer></script><script src="/myblog/assets/js/3.96770396.js" defer></script><script src="/myblog/assets/js/2.5abed595.js" defer></script><script src="/myblog/assets/js/94.c00f81a6.js" defer></script>
  </body>
</html>
